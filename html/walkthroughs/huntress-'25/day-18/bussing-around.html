<!DOCTYPE html> <html lang="en"><head>
<title>Bussing Around</title>
<base href="../../..">
<meta name="pathname" content="walkthroughs/huntress-'25/day-18/bussing-around.html">
<meta name="description" content="CTF-Writeups - Bussing Around">
<meta property="og:title" content="Bussing Around">
<meta property="og:description" content="CTF-Writeups - Bussing Around">
<meta property="og:type" content="website">
<meta property="og:url" content="walkthroughs/huntress-'25/day-18/bussing-around.html">
<meta property="og:image" content="undefined">
<meta charset="UTF-8"><meta property="og:site_name" content="CTF-Writeups"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="preload" href="site-lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/other-plugins.css"></noscript><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/supported-plugins.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event allow-fold-headings allow-fold-lists show-indentation-guide show-properties is-readable-line-width" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="Bussing_Around_0">Bussing Around</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-blockquote"><blockquote dir="auto">
<p><strong>Platform Name</strong>: CTF Challenge<br>
<strong>Category</strong>: <a href="?query=tag:Forensics" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Forensics">#Forensics</a> <a href="?query=tag:ICS" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#ICS">#ICS</a> <a href="?query=tag:SCADA" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#SCADA">#SCADA</a> <a href="?query=tag:Modbus" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Modbus">#Modbus</a><br>
<strong>Difficulty</strong>: Medium<br>
<strong>Date</strong>: October 18, 2025<br>
<strong>Author</strong>: Joe Lipinski</p>
</blockquote></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Table of Contents" dir="auto" class="heading" id="Table_of_Contents_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Table of Contents</h2></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><a class="internal-link" data-href="#introduction" href="#introduction" target="_self" rel="noopener nofollow">Introduction</a></li>
<li data-line="1" dir="auto"><a class="internal-link" data-href="#setup" href="#setup" target="_self" rel="noopener nofollow">Setup</a></li>
<li data-line="2" dir="auto"><a class="internal-link" data-href="#reconnaissance" href="#reconnaissance" target="_self" rel="noopener nofollow">Reconnaissance</a></li>
<li data-line="3" dir="auto"><a class="internal-link" data-href="#enumeration" href="#enumeration" target="_self" rel="noopener nofollow">Enumeration</a></li>
<li data-line="4" dir="auto"><a class="internal-link" data-href="#exploitation" href="#exploitation" target="_self" rel="noopener nofollow">Exploitation</a></li>
<li data-line="5" dir="auto"><a class="internal-link" data-href="#post-exploitationflag" href="#post-exploitationflag" target="_self" rel="noopener nofollow">Post-Exploitation/Flag</a></li>
<li data-line="6" dir="auto"><a class="internal-link" data-href="#lessons-learned" href="#lessons-learned" target="_self" rel="noopener nofollow">Lessons Learned</a></li>
<li data-line="7" dir="auto"><a class="internal-link" data-href="#references" href="#references" target="_self" rel="noopener nofollow">References</a></li>
</ol></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Introduction" dir="auto" class="heading" id="Introduction_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Introduction</h2></div><div class="el-p"><p dir="auto"><strong>Objective:</strong><br>
Extract a hidden flag from Modbus/TCP traffic captured in a PCAP file from an Industrial Control System (ICS) environment.</p></div><div class="el-p"><p dir="auto"><strong>Description:</strong><br>
An engineer noticed that an HMI (Human-Machine Interface) was behaving abnormally and captured network traffic. The traffic appears to be gibberish, but some of it originates from someone's computer rather than legitimate PLC traffic. Our goal is to analyze the Modbus protocol communications and extract the hidden data.</p></div><div class="el-p"><p dir="auto"><strong>Challenge Prompt:</strong></p></div><div class="el-pre"><pre><code data-line="0">One of the engineers noticed that an HMI was going haywire.

He took a packet capture of some of the traffic but he can't make any sense of it... 
it just looks like gibberish!

For some reason, some of the traffic seems to be coming from someone's computer. 
Can you help us figure out what's going on?
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Flag Format:</strong> <code>flag{[32 hex characters]}</code></p></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Setup" dir="auto" class="heading" id="Setup_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Setup</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Operating System:</strong> macOS (any Linux distribution with TShark works)</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Tools Used:</strong> 
<ul class="has-list-bullet">
<li data-line="2" dir="auto"><span class="list-bullet"></span><a href="?query=tag:TShark" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#TShark">#TShark</a> (Wireshark CLI tool)</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span><a href="?query=tag:Python3" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Python3">#Python3</a></li>
<li data-line="4" dir="auto"><span class="list-bullet"></span>Standard Unix utilities (unzip, cat)</li>
</ul>
</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span><strong>Files Provided:</strong> <code>bussing_around.pcapng</code></li>
</ul></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Verify TShark is installed</span>
tshark <span class="token parameter variable">--version</span>

<span class="token comment"># Verify Python3 is available</span>
python3 <span class="token parameter variable">--version</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Reconnaissance" dir="auto" class="heading" id="Reconnaissance_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Reconnaissance</h2></div><div class="el-h3"><h3 data-heading="Initial PCAP Analysis" dir="auto" class="heading" id="Initial_PCAP_Analysis_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Initial PCAP Analysis</h3></div><div class="el-p"><p dir="auto">First, we need to understand what's in the PCAP file and identify the communication patterns.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Check basic statistics about the capture</span>
tshark <span class="token parameter variable">-r</span> bussing_around.pcapng <span class="token parameter variable">-q</span> <span class="token parameter variable">-z</span> io,phs

<span class="token comment"># View TCP conversations</span>
tshark <span class="token parameter variable">-r</span> bussing_around.pcapng <span class="token parameter variable">-q</span> <span class="token parameter variable">-z</span> conv,tcp
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Findings:</strong></p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Single TCP Stream</strong>: <code>172.20.10.6:55995 &lt;-&gt; 172.20.10.2:502</code></li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>Port 502</strong>: Standard Modbus/TCP port</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>16,906 total frames</strong> with approximately 1.2 MB of data</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>Traffic duration: ~2.16 seconds</li>
</ul></div><div class="el-h3"><h3 data-heading="Modbus Traffic Overview" dir="auto" class="heading" id="Modbus_Traffic_Overview_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Modbus Traffic Overview</h3></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># View sample Modbus packets</span>
tshark <span class="token parameter variable">-r</span> bussing_around.pcapng <span class="token parameter variable">-Y</span> <span class="token string">"modbus"</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-20</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Key Observations:</strong></p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>Modbus Function Code 6: Write Single Register</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>Modbus Function Code 5: Write Single Coil</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>Traffic is from <code>172.20.10.6</code> (attacker's computer) to <code>172.20.10.2</code> (PLC/HMI)</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>Multiple Unit IDs in use: 3, 6, 12, 38</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Enumeration" dir="auto" class="heading" id="Enumeration_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Enumeration</h2></div><div class="el-h3"><h3 data-heading="Identifying Modbus Unit IDs" dir="auto" class="heading" id="Identifying_Modbus_Unit_IDs_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Identifying Modbus Unit IDs</h3></div><div class="el-p"><p dir="auto">Different Modbus unit IDs may contain different parts of the hidden data.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Count packets by unit ID</span>
tshark <span class="token parameter variable">-r</span> bussing_around.pcapng <span class="token parameter variable">-Y</span> <span class="token string">"modbus"</span> <span class="token parameter variable">-T</span> fields <span class="token parameter variable">-e</span> mbtcp.unit_id <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span> <span class="token parameter variable">-c</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Results:</strong></p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Unit 3</strong>: 2,240 packets (Function Code 6 - Write Register)</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>Unit 6</strong>: 2,274 packets (Function Code 6 - Write Register)</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>Unit 12</strong>: 2,224 packets (Function Code 5 - Write Coil)</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span><strong>Unit 38</strong>: 4,528 packets (Function Code 6 - Write Register) ⚠️ <strong>Twice as many!</strong></li>
</ul></div><div class="el-h3"><h3 data-heading="Analyzing Each Unit ID" dir="auto" class="heading" id="Analyzing_Each_Unit_ID_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Analyzing Each Unit ID</h3></div><div class="el-h4"><h4 data-heading="Unit 38 - The Suspicious Unit" dir="auto" class="heading" id="Unit_38_-_The_Suspicious_Unit_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Unit 38 - The Suspicious Unit</h4></div><div class="el-p"><p dir="auto">Unit 38 has exactly twice as many packets as the others, suggesting data duplication.</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Extract register values from Unit 38</span>
tshark <span class="token parameter variable">-r</span> bussing_around.pcapng <span class="token parameter variable">-Y</span> <span class="token string">"modbus.func_code == 6 &amp;&amp; mbtcp.unit_id == 38"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-T</span> fields <span class="token parameter variable">-e</span> modbus.regval_uint16 <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-20</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Discovery:</strong> Values are either 0 or 1, and each value appears twice consecutively!</p></div><div class="el-pre"><pre><code data-line="0">0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1...
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This is a <strong>bitstream</strong> where each bit is duplicated.</p></div><div class="el-h4"><h4 data-heading="Unit 3 - Base64-like Data" dir="auto" class="heading" id="Unit_3_-_Base64-like_Data_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Unit 3 - Base64-like Data</h4></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Extract register values from Unit 3</span>
tshark <span class="token parameter variable">-r</span> bussing_around.pcapng <span class="token parameter variable">-Y</span> <span class="token string">"modbus.func_code == 6 &amp;&amp; mbtcp.unit_id == 3"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-T</span> fields <span class="token parameter variable">-e</span> modbus.regval_uint16 <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-20</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Discovery:</strong> Values like 63, 79, 64, 43, 66, 78 appear twice. When converted to ASCII:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>63 = '?', 79 = 'O', 64 = '@', 43 = '+', 66 = 'B', 78 = 'N'</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>Pattern: <code>?O@+BNO...</code> resembles Base64 encoding</li>
</ul></div><div class="el-h4"><h4 data-heading="Unit 6 - Control Characters" dir="auto" class="heading" id="Unit_6_-_Control_Characters_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Unit 6 - Control Characters</h4></div><div class="el-p"><p dir="auto">Contains mostly non-printable characters with occasional <code>~</code> and <code>}</code> characters.</p></div><div class="el-h4"><h4 data-heading="Unit 12 - Coil Data" dir="auto" class="heading" id="Unit_12_-_Coil_Data_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Unit 12 - Coil Data</h4></div><div class="el-p"><p dir="auto">Uses Function Code 5 (Write Single Coil) with values <code>ff00</code> (ON) and <code>0000</code> (OFF).</p></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Exploitation" dir="auto" class="heading" id="Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Exploitation</h2></div><div class="el-h3"><h3 data-heading="Method 1: Analyzing Unit 3 (Dead End)" dir="auto" class="heading" id="Method_1_Analyzing_Unit_3_(Dead_End)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Method 1: Analyzing Unit 3 (Dead End)</h3></div><div class="el-p"><p dir="auto">Initially attempted to decode Unit 3 as Base64:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">tshark <span class="token parameter variable">-r</span> bussing_around.pcapng <span class="token parameter variable">-Y</span> <span class="token string">"modbus.func_code == 6 &amp;&amp; mbtcp.unit_id == 3"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-T</span> fields <span class="token parameter variable">-e</span> modbus.regval_uint16 <span class="token operator">|</span> python3 <span class="token parameter variable">-c</span> <span class="token string">"
import sys
import base64
values = [int(line.strip()) for line in sys.stdin if line.strip()]
# Take every other value (skip duplicates)
unique_vals = values[::2]
data = ''.join(chr(v) for v in unique_vals)
decoded = base64.b64decode(data)
print(decoded.decode('latin-1'))
"</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Result:</strong> Binary data, but no flag found. This was a decoy or additional layer.</p></div><div class="el-h3"><h3 data-heading="Method 2: Extracting ZIP File from Unit 38 (Success!)" dir="auto" class="heading" id="Method_2_Extracting_ZIP_File_from_Unit_38_(Success!)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Method 2: Extracting ZIP File from Unit 38 (Success!)</h3></div><div class="el-h4"><h4 data-heading="Step 1: Extract the Bitstream" dir="auto" class="heading" id="Step_1_Extract_the_Bitstream_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Step 1: Extract the Bitstream</h4></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded">tshark <span class="token parameter variable">-r</span> bussing_around.pcapng <span class="token punctuation">\</span>
  <span class="token parameter variable">-Y</span> <span class="token string">"modbus.func_code == 6 &amp;&amp; mbtcp.unit_id == 38"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-T</span> fields <span class="token parameter variable">-e</span> modbus.regval_uint16 <span class="token operator">|</span> python3 <span class="token parameter variable">-c</span> <span class="token string">"
import sys
values = [int(line.strip()) for line in sys.stdin if line.strip()]
# Take every other value to remove duplicates
unique_vals = values[::2]
bit_string = ''.join(str(v) for v in unique_vals)
# Convert bits to bytes
byte_data = bytearray()
for i in range(0, len(bit_string) - 7, 8):
    byte = bit_string[i:i+8]
    byte_data.append(int(byte, 2))
# Save to file
with open('extracted.zip', 'wb') as f:
    f.write(byte_data)
print('Saved', len(byte_data), 'bytes to extracted.zip')
"</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Output:</strong> <code>Saved 283 bytes to extracted.zip</code></p></div><div class="el-h4"><h4 data-heading="Step 2: Verify ZIP File" dir="auto" class="heading" id="Step_2_Verify_ZIP_File_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Step 2: Verify ZIP File</h4></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Check if it's a valid ZIP file</span>
<span class="token function">file</span> extracted.zip
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Result:</strong> <code>extracted.zip: Zip archive data, at least v1.0 to extract</code></p></div><div class="el-h4"><h4 data-heading="Step 3: Examine ZIP Contents" dir="auto" class="heading" id="Step_3_Examine_ZIP_Contents_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Step 3: Examine ZIP Contents</h4></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># List contents without extracting</span>
<span class="token function">unzip</span> <span class="token parameter variable">-l</span> extracted.zip
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Discovery:</strong> </p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>Contains <code>flag.txt</code></li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>ZIP comment reveals password: <code>The password is 5939f3ec9d820f23df20948af09a5682</code></li>
</ul></div><div class="el-h4"><h4 data-heading="Step 4: Extract with Password" dir="auto" class="heading" id="Step_4_Extract_with_Password_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Step 4: Extract with Password</h4></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">unzip</span> <span class="token parameter variable">-P</span> 5939f3ec9d820f23df20948af09a5682 extracted.zip
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Success!</strong> File <code>flag.txt</code> extracted.</p></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Post-Exploitation/Flag" dir="auto" class="heading" id="Post-Exploitation/Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Post-Exploitation/Flag</h2></div><div class="el-h3"><h3 data-heading="Capturing the Flag" dir="auto" class="heading" id="Capturing_the_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Capturing the Flag</h3></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token function">cat</span> flag.txt
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="success" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Flag</div></div><div class="callout-content">
<p dir="auto"><code>flag{4d2a66c5ed8bb8cd4e4e1ab32c71f7a3}</code></p>
</div></div></div><div class="el-h3"><h3 data-heading="Complete Solution Script" dir="auto" class="heading" id="Complete_Solution_Script_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Complete Solution Script</h3></div><div class="el-p"><p dir="auto">For future reference, here's a complete Python script to extract the flag:</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> subprocess
<span class="token keyword">import</span> sys

<span class="token comment"># Extract bitstream from Unit 38</span>
cmd <span class="token operator">=</span> <span class="token string">"tshark -r bussing_around.pcapng -Y 'modbus.func_code == 6 &amp;&amp; mbtcp.unit_id == 38' -T fields -e modbus.regval_uint16"</span>
result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> capture_output<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> line <span class="token keyword">in</span> result<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># Remove duplicates (take every other value)</span>
unique_vals <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>

<span class="token comment"># Convert to bitstring</span>
bit_string <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">for</span> v <span class="token keyword">in</span> unique_vals<span class="token punctuation">)</span>

<span class="token comment"># Convert bits to bytes</span>
byte_data <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bit_string<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    byte <span class="token operator">=</span> bit_string<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span>
    byte_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>byte<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Save ZIP file</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'extracted.zip'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>byte_data<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[+] Extracted </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>byte_data<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> bytes to extracted.zip"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Password found in ZIP comment: 5939f3ec9d820f23df20948af09a5682"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Extract with: unzip -P 5939f3ec9d820f23df20948af09a5682 extracted.zip"</span><span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Lessons Learned" dir="auto" class="heading" id="Lessons_Learned_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Lessons Learned</h2></div><div class="el-h3"><h3 data-heading="Key Takeaways" dir="auto" class="heading" id="Key_Takeaways_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Key Takeaways</h3></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Modbus Protocol Understanding</strong></p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>Modbus/TCP uses port 502</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>Function Code 6: Write Single Register (holds 16-bit values)</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>Function Code 5: Write Single Coil (binary on/off)</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span>Unit IDs can be used to multiplex different data streams</li>
</ul>
</li>
<li data-line="6" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Data Exfiltration via Industrial Protocols</strong></p>
<ul class="has-list-bullet">
<li data-line="7" dir="auto"><span class="list-bullet"></span>Attackers can abuse ICS protocols to hide data in plain sight</li>
<li data-line="8" dir="auto"><span class="list-bullet"></span>Modbus register writes can encode arbitrary data</li>
<li data-line="9" dir="auto"><span class="list-bullet"></span>Data duplication is a common technique to ensure reliability or evade detection</li>
</ul>
</li>
<li data-line="11" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Analysis Techniques</strong></p>
<ul class="has-list-bullet">
<li data-line="12" dir="auto"><span class="list-bullet"></span>Always enumerate ALL data sources (different unit IDs, function codes)</li>
<li data-line="13" dir="auto"><span class="list-bullet"></span>Look for patterns: duplicated values, unusual packet counts</li>
<li data-line="14" dir="auto"><span class="list-bullet"></span>Binary data often has magic numbers (e.g., <code>PK</code> for ZIP files)</li>
<li data-line="15" dir="auto"><span class="list-bullet"></span>Check for embedded metadata (ZIP comments, file headers)</li>
</ul>
</li>
<li data-line="17" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Tool Proficiency</strong></p>
<ul class="has-list-bullet">
<li data-line="18" dir="auto"><span class="list-bullet"></span>TShark is essential for automated PCAP analysis</li>
<li data-line="19" dir="auto"><span class="list-bullet"></span>Python is perfect for data transformation and decoding</li>
<li data-line="20" dir="auto"><span class="list-bullet"></span>Understanding file formats (ZIP, compression) helps identify hidden data</li>
</ul>
</li>
<li data-line="22" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Methodical Approach</strong></p>
<ul class="has-list-bullet">
<li data-line="23" dir="auto"><span class="list-bullet"></span>Don't get tunnel vision on the first promising lead</li>
<li data-line="24" dir="auto"><span class="list-bullet"></span>Unit 3 looked promising but was a red herring</li>
<li data-line="25" dir="auto"><span class="list-bullet"></span>Statistical analysis (packet counts) revealed Unit 38's importance</li>
<li data-line="26" dir="auto"><span class="list-bullet"></span>Always verify assumptions with data</li>
</ul>
</li>
</ol></div><div class="el-h3"><h3 data-heading="Common Pitfalls to Avoid" dir="auto" class="heading" id="Common_Pitfalls_to_Avoid_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Common Pitfalls to Avoid</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>❌ Assuming the first "readable" data is the answer</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>❌ Ignoring duplicated values as redundancy</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>❌ Not checking all available data streams (unit IDs)</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>❌ Overlooking file format magic numbers (PK, GIF, PNG, etc.)</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span>✅ Systematically enumerate all data sources</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span>✅ Look for anomalies in packet counts or patterns</li>
<li data-line="6" dir="auto"><span class="list-bullet"></span>✅ Test multiple decoding methods (ASCII, Base64, binary, hex)</li>
</ul></div><div class="el-h3"><h3 data-heading="Similar Challenge Patterns" dir="auto" class="heading" id="Similar_Challenge_Patterns_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Similar Challenge Patterns</h3></div><div class="el-p"><p dir="auto">This technique appears in challenges involving:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>DNS Tunneling</strong>: Data hidden in DNS queries/responses</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>ICMP Tunneling</strong>: Payloads in ping packets</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>HTTP Header Smuggling</strong>: Data in custom headers</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span><strong>Steganography</strong>: Files hidden in images or audio</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span><strong>Protocol Abuse</strong>: Any protocol can be misused for data exfiltration</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="References" dir="auto" class="heading" id="References_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>References</h2></div><div class="el-h3"><h3 data-heading="Tools" dir="auto" class="heading" id="Tools_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Tools</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://www.wireshark.org/docs/man-pages/tshark.html" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.wireshark.org/docs/man-pages/tshark.html" target="_self">TShark Documentation</a></li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://wiki.wireshark.org/DisplayFilters" rel="noopener nofollow" class="external-link is-unresolved" href="https://wiki.wireshark.org/DisplayFilters" target="_self">Wireshark Display Filters</a></li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.python.org/3/" rel="noopener nofollow" class="external-link is-unresolved" href="https://docs.python.org/3/" target="_self">Python3 Documentation</a></li>
</ul></div><div class="el-h3"><h3 data-heading="Modbus Protocol" dir="auto" class="heading" id="Modbus_Protocol_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Modbus Protocol</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://modbus.org/docs/Modbus_Application_Protocol_V1_1b3.pdf" rel="noopener nofollow" class="external-link is-unresolved" href="https://modbus.org/docs/Modbus_Application_Protocol_V1_1b3.pdf" target="_self">Modbus Protocol Specification</a></li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://www.simplymodbus.ca/FAQ.htm" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.simplymodbus.ca/FAQ.htm" target="_self">Modbus Function Codes</a></li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://www.cisa.gov/ics" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.cisa.gov/ics" target="_self">Industrial Control Systems Security</a></li>
</ul></div><div class="el-h3"><h3 data-heading="Similar Writeups" dir="auto" class="heading" id="Similar_Writeups_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Similar Writeups</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://notcicada.medium.com/write-up-the-magic-modbus-2692eaf5ee73" rel="noopener nofollow" class="external-link is-unresolved" href="https://notcicada.medium.com/write-up-the-magic-modbus-2692eaf5ee73" target="_self">The Magic Modbus CTF Writeup</a> - Inspired our approach</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://github.com/topics/scada-security" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/topics/scada-security" target="_self">SCADA CTF Challenges</a></li>
</ul></div><div class="el-h3"><h3 data-heading="Additional Resources" dir="auto" class="heading" id="Additional_Resources_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Additional Resources</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://www.sans.org/white-papers/36297/" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.sans.org/white-papers/36297/" target="_self">ICS/SCADA Security Best Practices</a></li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://modbus.org/docs/MB-TCP-Security-v21_2018-07-24.pdf" rel="noopener nofollow" class="external-link is-unresolved" href="https://modbus.org/docs/MB-TCP-Security-v21_2018-07-24.pdf" target="_self">Modbus Security Extensions</a></li>
</ul></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto"><strong>Disclaimer</strong><br>
This write-up is for educational purposes only. Always obtain proper authorization before testing or exploiting any system. Industrial Control Systems are critical infrastructure and should never be tested without explicit permission.</p></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto"><strong>Tags:</strong> <a href="?query=tag:Modbus" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Modbus">#Modbus</a> <a href="?query=tag:ICS" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#ICS">#ICS</a> <a href="?query=tag:SCADA" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#SCADA">#SCADA</a> <a href="?query=tag:Forensics" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Forensics">#Forensics</a> <a href="?query=tag:NetworkAnalysis" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#NetworkAnalysis">#NetworkAnalysis</a> <a href="?query=tag:TShark" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#TShark">#TShark</a> <a href="?query=tag:Python" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Python">#Python</a> <a href="?query=tag:DataExfiltration" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#DataExfiltration">#DataExfiltration</a> <a href="?query=tag:CTF" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#CTF">#CTF</a></p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="#Bussing_Around_0" data-path="#Bussing_Around_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Bussing Around">Bussing Around</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Table_of_Contents_0" data-path="#Table_of_Contents_0"><div class="tree-item-inner heading-link" heading-name="Table of Contents">Table of Contents</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Introduction_0" data-path="#Introduction_0"><div class="tree-item-inner heading-link" heading-name="Introduction">Introduction</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Setup_0" data-path="#Setup_0"><div class="tree-item-inner heading-link" heading-name="Setup">Setup</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Reconnaissance_0" data-path="#Reconnaissance_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Reconnaissance">Reconnaissance</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Initial_PCAP_Analysis_0" data-path="#Initial_PCAP_Analysis_0"><div class="tree-item-inner heading-link" heading-name="Initial PCAP Analysis">Initial PCAP Analysis</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Modbus_Traffic_Overview_0" data-path="#Modbus_Traffic_Overview_0"><div class="tree-item-inner heading-link" heading-name="Modbus Traffic Overview">Modbus Traffic Overview</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Enumeration_0" data-path="#Enumeration_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Enumeration">Enumeration</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Identifying_Modbus_Unit_IDs_0" data-path="#Identifying_Modbus_Unit_IDs_0"><div class="tree-item-inner heading-link" heading-name="Identifying Modbus Unit IDs">Identifying Modbus Unit IDs</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="#Analyzing_Each_Unit_ID_0" data-path="#Analyzing_Each_Unit_ID_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Analyzing Each Unit ID">Analyzing Each Unit ID</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="#Unit_38_-_The_Suspicious_Unit_0" data-path="#Unit_38_-_The_Suspicious_Unit_0"><div class="tree-item-inner heading-link" heading-name="Unit 38 - The Suspicious Unit">Unit 38 - The Suspicious Unit</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="#Unit_3_-_Base64-like_Data_0" data-path="#Unit_3_-_Base64-like_Data_0"><div class="tree-item-inner heading-link" heading-name="Unit 3 - Base64-like Data">Unit 3 - Base64-like Data</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="#Unit_6_-_Control_Characters_0" data-path="#Unit_6_-_Control_Characters_0"><div class="tree-item-inner heading-link" heading-name="Unit 6 - Control Characters">Unit 6 - Control Characters</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="#Unit_12_-_Coil_Data_0" data-path="#Unit_12_-_Coil_Data_0"><div class="tree-item-inner heading-link" heading-name="Unit 12 - Coil Data">Unit 12 - Coil Data</div></a><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Exploitation_0" data-path="#Exploitation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Exploitation">Exploitation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Method_1_Analyzing_Unit_3_(Dead_End)_0" data-path="#Method_1_Analyzing_Unit_3_(Dead_End)_0"><div class="tree-item-inner heading-link" heading-name="Method 1: Analyzing Unit 3 (Dead End)">Method 1: Analyzing Unit 3 (Dead End)</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="#Method_2_Extracting_ZIP_File_from_Unit_38_(Success!)_0" data-path="#Method_2_Extracting_ZIP_File_from_Unit_38_(Success!)_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Method 2: Extracting ZIP File from Unit 38 (Success!)">Method 2: Extracting ZIP File from Unit 38 (Success!)</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="#Step_1_Extract_the_Bitstream_0" data-path="#Step_1_Extract_the_Bitstream_0"><div class="tree-item-inner heading-link" heading-name="Step 1: Extract the Bitstream">Step 1: Extract the Bitstream</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="#Step_2_Verify_ZIP_File_0" data-path="#Step_2_Verify_ZIP_File_0"><div class="tree-item-inner heading-link" heading-name="Step 2: Verify ZIP File">Step 2: Verify ZIP File</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="#Step_3_Examine_ZIP_Contents_0" data-path="#Step_3_Examine_ZIP_Contents_0"><div class="tree-item-inner heading-link" heading-name="Step 3: Examine ZIP Contents">Step 3: Examine ZIP Contents</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="#Step_4_Extract_with_Password_0" data-path="#Step_4_Extract_with_Password_0"><div class="tree-item-inner heading-link" heading-name="Step 4: Extract with Password">Step 4: Extract with Password</div></a><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Post-Exploitation/Flag_0" data-path="#Post-Exploitation/Flag_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Post-Exploitation/Flag">Post-Exploitation/Flag</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Capturing_the_Flag_0" data-path="#Capturing_the_Flag_0"><div class="tree-item-inner heading-link" heading-name="Capturing the Flag">Capturing the Flag</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Complete_Solution_Script_0" data-path="#Complete_Solution_Script_0"><div class="tree-item-inner heading-link" heading-name="Complete Solution Script">Complete Solution Script</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Lessons_Learned_0" data-path="#Lessons_Learned_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Lessons Learned">Lessons Learned</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Key_Takeaways_0" data-path="#Key_Takeaways_0"><div class="tree-item-inner heading-link" heading-name="Key Takeaways">Key Takeaways</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Common_Pitfalls_to_Avoid_0" data-path="#Common_Pitfalls_to_Avoid_0"><div class="tree-item-inner heading-link" heading-name="Common Pitfalls to Avoid">Common Pitfalls to Avoid</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Similar_Challenge_Patterns_0" data-path="#Similar_Challenge_Patterns_0"><div class="tree-item-inner heading-link" heading-name="Similar Challenge Patterns">Similar Challenge Patterns</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#References_0" data-path="#References_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="References">References</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Tools_0" data-path="#Tools_0"><div class="tree-item-inner heading-link" heading-name="Tools">Tools</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Modbus_Protocol_0" data-path="#Modbus_Protocol_0"><div class="tree-item-inner heading-link" heading-name="Modbus Protocol">Modbus Protocol</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Similar_Writeups_0" data-path="#Similar_Writeups_0"><div class="tree-item-inner heading-link" heading-name="Similar Writeups">Similar Writeups</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Additional_Resources_0" data-path="#Additional_Resources_0"><div class="tree-item-inner heading-link" heading-name="Additional Resources">Additional Resources</div></a><div class="tree-item-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>