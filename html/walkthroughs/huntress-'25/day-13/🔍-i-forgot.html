<!DOCTYPE html> <html lang="en"><head>
<title>üîç I Forgot</title>
<base href="../../..">
<meta name="pathname" content="walkthroughs/huntress-'25/day-13/üîç-i-forgot.html">
<meta name="description" content="CTF-Writeups - üîç I Forgot">
<meta property="og:title" content="üîç I Forgot">
<meta property="og:description" content="CTF-Writeups - üîç I Forgot">
<meta property="og:type" content="website">
<meta property="og:url" content="walkthroughs/huntress-'25/day-13/üîç-i-forgot.html">
<meta property="og:image" content="undefined">
<meta charset="UTF-8"><meta property="og:site_name" content="CTF-Writeups"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="preload" href="site-lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/other-plugins.css"></noscript><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/supported-plugins.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:calc(2.3em + 2 * var(--sidebar-margin));width:var(--sidebar-width);padding:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row;border-top-right-radius:var(--radius-l)}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse;border-top-left-radius:var(--radius-l)}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:1px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#navbar:not(:empty){display:flex;align-items:center;justify-content:space-between;padding:.5em 1em;width:100%}#main{display:flex;flex-direction:column;height:100%;width:100%;align-items:stretch;justify-content:center}#main-horizontal{display:flex;flex-direction:row;flex-grow:1;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math,table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const n=await fetch(e);if(!n.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await n.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let n=document.createRange().createContextualFragment(o);t.before(n),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(n){let l=o[n],c=n+1;l?(l&&"true"!=l.getAttribute("loaded")||n<o.length&&e(c),n<o.length&&l.addEventListener("load",(()=>e(c)))):n<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div id="main"><div id="navbar"></div><div id="main-horizontal"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event allow-fold-headings allow-fold-lists show-indentation-guide show-properties is-readable-line-width" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="üîç_I_Forgot_0">üîç I Forgot</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-blockquote"><blockquote dir="auto">
<p><strong>Platform Name</strong>: CTF Challenge<br>
<strong>Category</strong>: <a href="?query=tag:Forensics" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Forensics">#Forensics</a> <a href="?query=tag:Cryptography" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Cryptography">#Cryptography</a> <a href="?query=tag:Memory" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Memory">#Memory</a><br>
<strong>Difficulty</strong>: Hard<br>
<strong>Date</strong>: October 14, 2025<br>
<strong>Author</strong>: Joe Lipinski</p>
</blockquote></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Table of Contents" dir="auto" class="heading" id="Table_of_Contents_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Table of Contents</h2></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><a class="internal-link" data-href="#introduction" href="#introduction" target="_self" rel="noopener nofollow">Introduction</a></li>
<li data-line="1" dir="auto"><a class="internal-link" data-href="#setup" href="#setup" target="_self" rel="noopener nofollow">Setup</a></li>
<li data-line="2" dir="auto"><a class="internal-link" data-href="#reconnaissance" href="#reconnaissance" target="_self" rel="noopener nofollow">Reconnaissance</a></li>
<li data-line="3" dir="auto"><a class="internal-link" data-href="#enumeration" href="#enumeration" target="_self" rel="noopener nofollow">Enumeration</a></li>
<li data-line="4" dir="auto"><a class="internal-link" data-href="#exploitation" href="#exploitation" target="_self" rel="noopener nofollow">Exploitation</a></li>
<li data-line="5" dir="auto"><a class="internal-link" data-href="#post-exploitationflag" href="#post-exploitationflag" target="_self" rel="noopener nofollow">Post-Exploitation/Flag</a></li>
<li data-line="6" dir="auto"><a class="internal-link" data-href="#lessons-learned" href="#lessons-learned" target="_self" rel="noopener nofollow">Lessons Learned</a></li>
<li data-line="7" dir="auto"><a class="internal-link" data-href="#references" href="#references" target="_self" rel="noopener nofollow">References</a></li>
</ol></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Introduction" dir="auto" class="heading" id="Introduction_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Introduction</h2></div><div class="el-p"><p dir="auto"><strong>Objective:</strong><br>
Analyze a Windows memory dump to extract encryption keys and decrypt an encrypted flag file. This challenge combines memory forensics, cryptographic analysis, and reverse engineering skills.</p></div><div class="el-p"><p dir="auto"><strong>Description:</strong><br>
The challenge provides three files:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><code>memdump.dmp</code> - A Windows 10 memory dump (captured 2025-09-28 04:42:02 UTC)</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><code>flag.enc</code> - An encrypted file containing the flag (208 bytes)</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><code>memory_strings.txt</code> - Pre-extracted strings from the memory dump</li>
</ul></div><div class="el-p"><p dir="auto">The goal is to find the decryption key hidden in the memory dump and decrypt the flag file.</p></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Setup" dir="auto" class="heading" id="Setup_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Setup</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Operating System:</strong> macOS (any Unix-like system with Python 3)</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Tools Used:</strong> 
<ul class="has-list-bullet">
<li data-line="2" dir="auto"><span class="list-bullet"></span><a href="?query=tag:Volatility3" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Volatility3">#Volatility3</a> (memory forensics framework)</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span><a href="?query=tag:Python3" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Python3">#Python3</a> with PyCryptodome library</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span><a href="?query=tag:OpenSSL" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#OpenSSL">#OpenSSL</a> (cryptographic operations)</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span>Standard Unix utilities: <code>strings</code>, <code>grep</code>, <code>hexdump</code></li>
</ul>
</li>
<li data-line="6" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Files Provided:</strong>
<ul class="has-list-bullet">
<li data-line="7" dir="auto"><span class="list-bullet"></span><code>memdump.dmp</code> (Windows memory dump)</li>
<li data-line="8" dir="auto"><span class="list-bullet"></span><code>flag.enc</code> (encrypted flag file)</li>
<li data-line="9" dir="auto"><span class="list-bullet"></span><code>memory_strings.txt</code> (1.7M lines)</li>
</ul>
</li>
</ul></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Install required Python libraries</span>
pip <span class="token function">install</span> pycryptodome

<span class="token comment"># Verify Volatility3 is available (if using)</span>
vol <span class="token parameter variable">--version</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Reconnaissance" dir="auto" class="heading" id="Reconnaissance_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Reconnaissance</h2></div><div class="el-h3"><h3 data-heading="Initial File Analysis" dir="auto" class="heading" id="Initial_File_Analysis_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Initial File Analysis</h3></div><div class="el-p"><p dir="auto">First, examine the provided files to understand what we're working with:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Check file sizes and types</span>
<span class="token function">ls</span> <span class="token parameter variable">-lh</span>
<span class="token function">file</span> memdump.dmp flag.enc

<span class="token comment"># Examine the encrypted flag file</span>
hexdump <span class="token parameter variable">-C</span> flag.enc <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-20</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Key Observations:</strong></p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><code>flag.enc</code> is 208 bytes of binary data</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>Starts with bytes: <code>47 03 54 30 61 ad 8b 4f...</code></li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>No obvious file signature or header</li>
</ul></div><div class="el-h3"><h3 data-heading="Memory Dump Analysis (Optional - Using Volatility3)" dir="auto" class="heading" id="Memory_Dump_Analysis_(Optional_-_Using_Volatility3)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Memory Dump Analysis (Optional - Using Volatility3)</h3></div><div class="el-p"><p dir="auto">If you have Volatility3 available, you can analyze the memory dump:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Identify the OS profile</span>
vol <span class="token parameter variable">-f</span> memdump.dmp windows.info

<span class="token comment"># List running processes</span>
vol <span class="token parameter variable">-f</span> memdump.dmp windows.pslist
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Findings:</strong></p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>Windows 10 Build 26100</strong></li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>BackupHelper.exe</strong> (PID 2132) - Suspicious encryption-related process</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>PowerShell</strong> (PID 5920) - Likely ran the BackupHelper program</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Enumeration" dir="auto" class="heading" id="Enumeration_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Enumeration</h2></div><div class="el-h3"><h3 data-heading="Step 1: Search Memory Strings for Encryption Clues" dir="auto" class="heading" id="Step_1_Search_Memory_Strings_for_Encryption_Clues_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Step 1: Search Memory Strings for Encryption Clues</h3></div><div class="el-p"><p dir="auto">The provided <code>memory_strings.txt</code> file contains all strings extracted from the memory dump. Search for encryption-related keywords:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Look for encryption-related strings</span>
<span class="token function">grep</span> <span class="token parameter variable">-i</span> <span class="token string">"encrypt\|decrypt\|key\|aes\|rsa"</span> memory_strings.txt <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-50</span>

<span class="token comment"># Search for file references</span>
<span class="token function">grep</span> <span class="token parameter variable">-i</span> <span class="token string">"flag\|backup\|helper"</span> memory_strings.txt <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-30</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Key Discoveries:</strong></p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">References to <code>BackupHelper.exe</code> and <code>BackupHelper.cs</code></li>
<li data-line="1" dir="auto">Mentions of <code>DECRYPT_PRIVATE_KEY.zip</code></li>
<li data-line="2" dir="auto">Log messages: "BackupHelper started: 2025-09-28T04:41:52.5463814Z"</li>
<li data-line="3" dir="auto">Evidence of AES-CTR encryption: <code>;varoutput=aes.ctr.decrypt</code></li>
</ol></div><div class="el-h3"><h3 data-heading="Step 2: Extract ZIP Archive from Memory" dir="auto" class="heading" id="Step_2_Extract_ZIP_Archive_from_Memory_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Step 2: Extract ZIP Archive from Memory</h3></div><div class="el-p"><p dir="auto">The memory strings revealed a ZIP file containing decryption keys. Search for the ZIP file signature in the memory dump:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Dump the BackupHelper process memory (if using Volatility)</span>
vol <span class="token parameter variable">-f</span> memdump.dmp windows.memmap <span class="token parameter variable">--pid</span> <span class="token number">2132</span> <span class="token parameter variable">--dump</span>

<span class="token comment"># Search for ZIP signature in the dumped memory</span>
<span class="token function">grep</span> <span class="token parameter variable">-abo</span> <span class="token string">"PK"</span> pid.2132.dmp <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-20</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Create a Python script to extract the ZIP file:</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token comment">#!/usr/bin/env python3</span>

<span class="token comment"># Read the process memory dump</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'pid.2132.dmp'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Find ZIP file signature (PK)</span>
pk_offset <span class="token operator">=</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">b'PK\x03\x04'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Found ZIP at offset: 0x</span><span class="token interpolation"><span class="token punctuation">{</span>pk_offset<span class="token punctuation">:</span><span class="token format-spec">08x</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># ZIP files end with "PK\x05\x06" (end of central directory)</span>
end_offset <span class="token operator">=</span> data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">b'PK\x05\x06'</span><span class="token punctuation">,</span> pk_offset<span class="token punctuation">)</span>
<span class="token keyword">if</span> end_offset <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
    <span class="token comment"># Include the end-of-central-directory record (22 bytes minimum)</span>
    end_offset <span class="token operator">+=</span> <span class="token number">22</span>
    
    zip_data <span class="token operator">=</span> data<span class="token punctuation">[</span>pk_offset<span class="token punctuation">:</span>end_offset<span class="token punctuation">]</span>
    
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'DECRYPT_PRIVATE_KEY.zip'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> out<span class="token punctuation">:</span>
        out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>zip_data<span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Extracted </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>zip_data<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> bytes to DECRYPT_PRIVATE_KEY.zip"</span></span><span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Results:</strong></p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>ZIP file found at offset <code>0x00004000</code></li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>Extracted 1938 bytes to <code>DECRYPT_PRIVATE_KEY.zip</code></li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>ZIP is password-protected</li>
</ul></div><div class="el-h3"><h3 data-heading="Step 3: Find ZIP Password" dir="auto" class="heading" id="Step_3_Find_ZIP_Password_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Step 3: Find ZIP Password</h3></div><div class="el-p"><p dir="auto">Search the memory strings for the ZIP password:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># The ZIP password is likely stored in memory near the ZIP file reference</span>
<span class="token function">grep</span> <span class="token parameter variable">-B</span> <span class="token number">5</span> <span class="token parameter variable">-A</span> <span class="token number">5</span> <span class="token string">"DECRYPT_PRIVATE_KEY"</span> memory_strings.txt

<span class="token comment"># Search for password patterns (alphanumeric strings)</span>
<span class="token function">grep</span> <span class="token parameter variable">-E</span> <span class="token string">'^[a-zA-Z0-9]{16}$'</span> memory_strings.txt <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-20</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Password Found:</strong> <code>ePDaACdOCwaMiYDG</code></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Extract ZIP contents</span>
<span class="token function">unzip</span> <span class="token parameter variable">-P</span> ePDaACdOCwaMiYDG DECRYPT_PRIVATE_KEY.zip
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>ZIP Contents:</strong></p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><code>private.pem</code> - RSA private key (1708 bytes)</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><code>key.enc</code> - RSA-encrypted symmetric key material (256 bytes)</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Exploitation" dir="auto" class="heading" id="Exploitation_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Exploitation</h2></div><div class="el-h3"><h3 data-heading="Step 1: Decrypt the RSA-Encrypted Key" dir="auto" class="heading" id="Step_1_Decrypt_the_RSA-Encrypted_Key_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Step 1: Decrypt the RSA-Encrypted Key</h3></div><div class="el-p"><p dir="auto">The <code>key.enc</code> file contains symmetric key material encrypted with RSA. Try decrypting it:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># First attempt: PKCS1 padding (WRONG - but commonly tried first)</span>
openssl pkeyutl <span class="token parameter variable">-decrypt</span> <span class="token parameter variable">-inkey</span> private.pem <span class="token parameter variable">-in</span> key.enc <span class="token punctuation">\</span>
    <span class="token parameter variable">-out</span> key_pkcs1.bin <span class="token parameter variable">-pkeyopt</span> rsa_padding_mode:pkcs1

hexdump <span class="token parameter variable">-C</span> key_pkcs1.bin
<span class="token comment"># Result: 44 bytes (32-byte key + 12-byte nonce)</span>
<span class="token comment"># This is INCORRECT - 12 bytes is unusual for standard AES modes</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Critical Insight:</strong> The 44-byte result (32+12) is a red flag. Standard AES modes use:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>CBC:</strong> 16-byte IV</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>GCM:</strong> 12-byte nonce + 16-byte tag</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>CTR:</strong> 8 or 16-byte nonce</li>
</ul></div><div class="el-p"><p dir="auto">The correct approach uses <strong>RSA-OAEP padding</strong>:</p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Correct decryption: OAEP padding</span>
openssl pkeyutl <span class="token parameter variable">-decrypt</span> <span class="token parameter variable">-inkey</span> private.pem <span class="token parameter variable">-in</span> key.enc <span class="token punctuation">\</span>
    <span class="token parameter variable">-out</span> key_oaep.bin <span class="token parameter variable">-pkeyopt</span> rsa_padding_mode:oaep

hexdump <span class="token parameter variable">-C</span> key_oaep.bin
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Results:</strong></p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>48 bytes</strong> decrypted successfully</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>Format: 32-byte AES-256 key + 16-byte IV</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>Key: <code>289ea58a38549d5faf7a97a6dd19cdf2ddc0496a8a64f99a77c643529c94b804</code></li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>IV: <code>2c6a55b0a89141056517687a977305d6</code></li>
</ul></div><div class="el-h3"><h3 data-heading="Step 2: Decrypt the Flag File" dir="auto" class="heading" id="Step_2_Decrypt_the_Flag_File_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Step 2: Decrypt the Flag File</h3></div><div class="el-p"><p dir="auto">Now that we have the correct key material (32-byte key + 16-byte IV), decrypt the flag:</p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES

<span class="token comment"># Read the OAEP-decrypted key material</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'key_oaep.bin'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

key <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>  <span class="token comment"># 32 bytes for AES-256</span>
iv <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token punctuation">]</span>   <span class="token comment"># 16 bytes for CBC mode</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Key (32 bytes): </span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"IV (16 bytes): </span><span class="token interpolation"><span class="token punctuation">{</span>iv<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># Read the encrypted flag</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.enc'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    encrypted_data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Decrypt using AES-256-CBC</span>
cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token operator">=</span>iv<span class="token punctuation">)</span>
decrypted <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>encrypted_data<span class="token punctuation">)</span>

<span class="token comment"># Remove PKCS7 padding</span>
pad_len <span class="token operator">=</span> decrypted<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">if</span> pad_len <span class="token operator">&lt;=</span> <span class="token number">16</span> <span class="token keyword">and</span> pad_len <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
    unpadded <span class="token operator">=</span> decrypted<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span>pad_len<span class="token punctuation">]</span>
    result <span class="token operator">=</span> unpadded<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"="</span><span class="token operator">*</span><span class="token number">70</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"SUCCESS!"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token operator">*</span><span class="token number">70</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Alternative: Using OpenSSL</strong></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Extract key and IV to separate files</span>
<span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>key_oaep.bin <span class="token assign-left variable">of</span><span class="token operator">=</span>aes_key.bin <span class="token assign-left variable">bs</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">32</span>
<span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>key_oaep.bin <span class="token assign-left variable">of</span><span class="token operator">=</span>aes_iv.bin <span class="token assign-left variable">bs</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">skip</span><span class="token operator">=</span><span class="token number">32</span> <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">16</span>

<span class="token comment"># Decrypt using OpenSSL</span>
openssl enc <span class="token parameter variable">-d</span> -aes-256-cbc <span class="token parameter variable">-in</span> flag.enc <span class="token parameter variable">-out</span> flag.txt <span class="token punctuation">\</span>
    <span class="token parameter variable">-K</span> <span class="token variable"><span class="token variable">$(</span>xxd <span class="token parameter variable">-p</span> <span class="token parameter variable">-c</span> <span class="token number">32</span> aes_key.bin<span class="token variable">)</span></span> <span class="token punctuation">\</span>
    <span class="token parameter variable">-iv</span> <span class="token variable"><span class="token variable">$(</span>xxd <span class="token parameter variable">-p</span> <span class="token parameter variable">-c</span> <span class="token number">16</span> aes_iv.bin<span class="token variable">)</span></span>

<span class="token function">cat</span> flag.txt
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Post-Exploitation/Flag" dir="auto" class="heading" id="Post-Exploitation/Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Post-Exploitation/Flag</h2></div><div class="el-h3"><h3 data-heading="Capturing the Flag" dir="auto" class="heading" id="Capturing_the_Flag_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Capturing the Flag</h3></div><div class="el-p"><p dir="auto">Running the decryption script successfully reveals:</p></div><div class="el-pre"><pre><code data-line="0">=== CONFIDENTIAL RECOVERY ===
Note: This file contains the recovered data for decryption.
-----------------------------
FLAG:
flag{fa838fa9823e5d612b25001740faca31}
-----------------------------
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre><div><pre class="dataview dataview-error">Dataview (inline field '== CONFIDENTIAL RECOVERY ===
Note: This file contains the recovered data for decryption.
-----------------------------
FLAG:
flag{fa838fa9823e5d612b25001740faca31}
-----------------------------'): Error: 
-- PARSING FAILED --------------------------------------------------

&gt; 1 | == CONFIDENTIAL RECOVERY ===
    | ^
  2 | Note: This file contains the recovered data for decryption.
  3 | -----------------------------

Expected one of the following: 

'(', 'null', boolean, date, duration, file link, list ('[1, 2, 3]'), negated field, number, object ('{ a: 1, b: 2 }'), string, variable
</pre></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="success" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Flag</div></div><div class="callout-content">
<p dir="auto"><code>flag{fa838fa9823e5d612b25001740faca31}</code></p>
</div></div></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="Lessons Learned" dir="auto" class="heading" id="Lessons_Learned_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Lessons Learned</h2></div><div class="el-h3"><h3 data-heading="Key Takeaways" dir="auto" class="heading" id="Key_Takeaways_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Key Takeaways</h3></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>RSA Padding Matters</strong></p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>Always try both PKCS1 and OAEP padding when decrypting RSA-encrypted data</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>OAEP is more secure and increasingly common in modern implementations</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>Different padding schemes produce different plaintext lengths</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span>A 44-byte result from PKCS1 was a clue that the padding was wrong</li>
</ul>
</li>
<li data-line="6" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Memory Forensics Workflow</strong></p>
<ul class="has-list-bullet">
<li data-line="7" dir="auto"><span class="list-bullet"></span>Start with <code>strings</code> extraction - it's fast and often sufficient</li>
<li data-line="8" dir="auto"><span class="list-bullet"></span>Look for process-specific artifacts (log files, config data)</li>
<li data-line="9" dir="auto"><span class="list-bullet"></span>Suspicious process names like "BackupHelper" warrant deeper investigation</li>
<li data-line="10" dir="auto"><span class="list-bullet"></span>Process memory dumps (<code>windows.memmap</code>) contain more detail than full dumps</li>
</ul>
</li>
<li data-line="12" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Cryptographic Analysis</strong></p>
<ul class="has-list-bullet">
<li data-line="13" dir="auto"><span class="list-bullet"></span>Don't assume the encryption scheme - verify with evidence</li>
<li data-line="14" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Standard key/IV sizes are hints: 
<ul class="has-list-bullet">
<li data-line="15" dir="auto"><span class="list-bullet"></span>32 bytes = AES-256 key</li>
<li data-line="16" dir="auto"><span class="list-bullet"></span>16 bytes = CBC IV</li>
<li data-line="17" dir="auto"><span class="list-bullet"></span>12 bytes = GCM nonce</li>
</ul>
</li>
<li data-line="18" dir="auto"><span class="list-bullet"></span>Test multiple modes systematically when uncertain</li>
</ul>
</li>
<li data-line="20" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Binary File Extraction from Memory</strong></p>
<ul class="has-list-bullet">
<li data-line="21" dir="auto"><span class="list-bullet"></span>Use file signatures (magic bytes) to locate embedded files</li>
<li data-line="22" dir="auto"><span class="list-bullet"></span>For ZIP files: <code>PK\x03\x04</code> (start) and <code>PK\x05\x06</code> (end)</li>
<li data-line="23" dir="auto"><span class="list-bullet"></span>Account for full file structure including headers and footers</li>
</ul>
</li>
<li data-line="25" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Password Discovery</strong></p>
<ul class="has-list-bullet">
<li data-line="26" dir="auto"><span class="list-bullet"></span>Passwords are often stored in plaintext in memory</li>
<li data-line="27" dir="auto"><span class="list-bullet"></span>Search near related artifacts (file names, log messages)</li>
<li data-line="28" dir="auto"><span class="list-bullet"></span>Try pattern matching for common formats (16-char alphanumeric, etc.)</li>
</ul>
</li>
</ol></div><div class="el-h3"><h3 data-heading="Common Pitfalls (That We Encountered)" dir="auto" class="heading" id="Common_Pitfalls_(That_We_Encountered)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Common Pitfalls (That We Encountered)</h3></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>False Leads</strong></p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>Initial "cryptography.fernet" strings led to wasted effort testing Fernet</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>Malware signatures in memory can be misleading</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>Always verify encryption type with multiple sources of evidence</li>
</ul>
</li>
<li data-line="5" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Incorrect Padding Assumptions</strong></p>
<ul class="has-list-bullet">
<li data-line="6" dir="auto"><span class="list-bullet"></span>PKCS1 gave 44 bytes which seemed plausible but was wrong</li>
<li data-line="7" dir="auto"><span class="list-bullet"></span>The unusual 12-byte "nonce" should have been a red flag earlier</li>
<li data-line="8" dir="auto"><span class="list-bullet"></span>Test both PKCS1 and OAEP before attempting decryption</li>
</ul>
</li>
<li data-line="10" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Overcomplicating the Solution</strong></p>
<ul class="has-list-bullet">
<li data-line="11" dir="auto"><span class="list-bullet"></span>Tried complex CTR counter configurations unnecessarily</li>
<li data-line="12" dir="auto"><span class="list-bullet"></span>The solution was simpler: correct RSA padding + standard CBC mode</li>
</ul>
</li>
</ol></div><div class="el-h3"><h3 data-heading="Tools and Techniques for Future CTFs" dir="auto" class="heading" id="Tools_and_Techniques_for_Future_CTFs_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Tools and Techniques for Future CTFs</h3></div><div class="el-p"><p dir="auto"><strong>Essential Tools:</strong></p></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Memory forensics</span>
volatility3
strings + <span class="token function">grep</span>

<span class="token comment"># Cryptography</span>
openssl
python3 + PyCryptodome

<span class="token comment"># Binary analysis</span>
hexdump / xxd
<span class="token function">file</span>
binwalk <span class="token punctuation">(</span>for finding embedded files<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Python Libraries:</strong></p></div><div class="el-pre"><pre class="language-python"><code data-line="0" class="language-python is-loaded"><span class="token comment"># Essential for CTF crypto challenges</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token punctuation">,</span> DES<span class="token punctuation">,</span> DES3  <span class="token comment"># Symmetric encryption</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA           <span class="token comment"># Asymmetric keys</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>Padding <span class="token keyword">import</span> pad<span class="token punctuation">,</span> unpad <span class="token comment"># Padding helpers</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Hash <span class="token keyword">import</span> SHA256<span class="token punctuation">,</span> MD5        <span class="token comment"># Hashing</span>
<span class="token keyword">import</span> base64                               <span class="token comment"># Encoding</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>Systematic Approach to Unknown Encryption:</strong></p></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Identify the scheme:</strong></p>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>File sizes (ciphertext = plaintext + padding/overhead)</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>Key/IV lengths in memory</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>Library imports or function names</li>
</ul>
</li>
<li data-line="5" dir="auto">
<p><strong>Test RSA padding modes:</strong></p>
<pre class="language-bash"><code data-line="6" class="language-bash is-loaded"><span class="token comment"># Try both</span>
openssl pkeyutl <span class="token punctuation">..</span>. <span class="token parameter variable">-pkeyopt</span> rsa_padding_mode:pkcs1
openssl pkeyutl <span class="token punctuation">..</span>. <span class="token parameter variable">-pkeyopt</span> rsa_padding_mode:oaep
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="12" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Test AES modes systematically:</strong></p>
<ul class="has-list-bullet">
<li data-line="13" dir="auto"><span class="list-bullet"></span>CBC (most common, needs IV)</li>
<li data-line="14" dir="auto"><span class="list-bullet"></span>GCM (authenticated, needs nonce + tag)</li>
<li data-line="15" dir="auto"><span class="list-bullet"></span>CTR (streaming, needs nonce/counter)</li>
<li data-line="16" dir="auto"><span class="list-bullet"></span>ECB (insecure, no IV needed)</li>
</ul>
</li>
<li data-line="18" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Handle padding:</strong></p>
<ul class="has-list-bullet">
<li data-line="19" dir="auto"><span class="list-bullet"></span>PKCS7 is standard (Python: <code>unpad(data, AES.block_size)</code>)</li>
<li data-line="20" dir="auto"><span class="list-bullet"></span>Last byte indicates padding length</li>
<li data-line="21" dir="auto"><span class="list-bullet"></span>Manual removal: <code>data[:-data[-1]]</code></li>
</ul>
</li>
</ol></div><div class="el-h3"><h3 data-heading="Quick Reference Commands" dir="auto" class="heading" id="Quick_Reference_Commands_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Quick Reference Commands</h3></div><div class="el-pre"><pre class="language-bash"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Extract strings from memory dump</span>
strings <span class="token parameter variable">-a</span> <span class="token parameter variable">-t</span> d memdump.dmp <span class="token operator">&gt;</span> memory_strings.txt

<span class="token comment"># Search for patterns</span>
<span class="token function">grep</span> <span class="token parameter variable">-abo</span> <span class="token string">"pattern"</span> file.bin          <span class="token comment"># Binary search with offset</span>
<span class="token function">grep</span> <span class="token parameter variable">-E</span> <span class="token string">'^.{16}$'</span> strings.txt         <span class="token comment"># Regex for exact length</span>

<span class="token comment"># Dump process memory (Volatility3)</span>
vol <span class="token parameter variable">-f</span> dump.dmp windows.memmap <span class="token parameter variable">--pid</span> PID <span class="token parameter variable">--dump</span>

<span class="token comment"># RSA decryption (try both paddings)</span>
openssl pkeyutl <span class="token parameter variable">-decrypt</span> <span class="token parameter variable">-inkey</span> priv.pem <span class="token parameter variable">-in</span> enc.bin <span class="token punctuation">\</span>
    <span class="token parameter variable">-pkeyopt</span> rsa_padding_mode:oaep <span class="token parameter variable">-out</span> dec.bin

<span class="token comment"># AES-CBC decryption</span>
openssl enc <span class="token parameter variable">-d</span> -aes-256-cbc <span class="token parameter variable">-in</span> enc.bin <span class="token parameter variable">-out</span> dec.txt <span class="token punctuation">\</span>
    <span class="token parameter variable">-K</span> <span class="token variable"><span class="token variable">$(</span>xxd <span class="token parameter variable">-p</span> key.bin<span class="token variable">)</span></span> <span class="token parameter variable">-iv</span> <span class="token variable"><span class="token variable">$(</span>xxd <span class="token parameter variable">-p</span> iv.bin<span class="token variable">)</span></span>

<span class="token comment"># Examine binary files</span>
hexdump <span class="token parameter variable">-C</span> file.bin <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-20</span>        <span class="token comment"># Hex viewer</span>
xxd file.bin <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-20</span>                <span class="token comment"># Alternative hex viewer</span>
<span class="token function">file</span> file.bin                          <span class="token comment"># Identify file type</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="References" dir="auto" class="heading" id="References_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>References</h2></div><div class="el-h3"><h3 data-heading="Tools" dir="auto" class="heading" id="Tools_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Tools</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Volatility3</strong>: <a rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/volatilityfoundation/volatility3" target="_self">https://github.com/volatilityfoundation/volatility3</a>
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>Memory forensics framework for extracting digital artifacts</li>
</ul>
</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>PyCryptodome</strong>: <a rel="noopener nofollow" class="external-link is-unresolved" href="https://pycryptodome.readthedocs.io/" target="_self">https://pycryptodome.readthedocs.io/</a>
<ul class="has-list-bullet">
<li data-line="3" dir="auto"><span class="list-bullet"></span>Python cryptography library</li>
</ul>
</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>OpenSSL</strong>: <a rel="noopener nofollow" class="external-link is-unresolved" href="https://www.openssl.org/docs/" target="_self">https://www.openssl.org/docs/</a>
<ul class="has-list-bullet">
<li data-line="5" dir="auto"><span class="list-bullet"></span>Cryptographic toolkit</li>
</ul>
</li>
</ul></div><div class="el-h3"><h3 data-heading="Techniques" dir="auto" class="heading" id="Techniques_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Techniques</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>RSA Padding Schemes</strong>: 
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>PKCS#1 v1.5: <a rel="noopener nofollow" class="external-link is-unresolved" href="https://datatracker.ietf.org/doc/html/rfc2313" target="_self">https://datatracker.ietf.org/doc/html/rfc2313</a></li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>OAEP: <a rel="noopener nofollow" class="external-link is-unresolved" href="https://datatracker.ietf.org/doc/html/rfc2437" target="_self">https://datatracker.ietf.org/doc/html/rfc2437</a></li>
</ul>
</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>AES Modes of Operation</strong>: 
<ul class="has-list-bullet">
<li data-line="4" dir="auto"><span class="list-bullet"></span>NIST SP 800-38A: <a rel="noopener nofollow" class="external-link is-unresolved" href="https://csrc.nist.gov/publications/detail/sp/800-38a/final" target="_self">https://csrc.nist.gov/publications/detail/sp/800-38a/final</a></li>
</ul>
</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Memory Forensics</strong>:
<ul class="has-list-bullet">
<li data-line="6" dir="auto"><span class="list-bullet"></span>"The Art of Memory Forensics" by Michael Hale Ligh et al.</li>
</ul>
</li>
</ul></div><div class="el-h3"><h3 data-heading="CTF Resources" dir="auto" class="heading" id="CTF_Resources_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>CTF Resources</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>CryptoHack</strong>: <a rel="noopener nofollow" class="external-link is-unresolved" href="https://cryptohack.org/" target="_self">https://cryptohack.org/</a> - Learn cryptography through challenges</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>Memory Forensics Training</strong>: <a rel="noopener nofollow" class="external-link is-unresolved" href="https://www.memoryanalysis.net/" target="_self">https://www.memoryanalysis.net/</a></li>
</ul></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto"><strong>Disclaimer</strong><br>
This write-up is for educational purposes only. The techniques described should only be used in authorized CTF competitions, penetration testing engagements, or personal learning environments. Always obtain proper authorization before testing or exploiting any system.</p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="#üîç_I_Forgot_0" data-path="#üîç_I_Forgot_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="üîç I Forgot">üîç I Forgot</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Table_of_Contents_0" data-path="#Table_of_Contents_0"><div class="tree-item-inner heading-link" heading-name="Table of Contents">Table of Contents</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Introduction_0" data-path="#Introduction_0"><div class="tree-item-inner heading-link" heading-name="Introduction">Introduction</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="#Setup_0" data-path="#Setup_0"><div class="tree-item-inner heading-link" heading-name="Setup">Setup</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Reconnaissance_0" data-path="#Reconnaissance_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Reconnaissance">Reconnaissance</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Initial_File_Analysis_0" data-path="#Initial_File_Analysis_0"><div class="tree-item-inner heading-link" heading-name="Initial File Analysis">Initial File Analysis</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Memory_Dump_Analysis_(Optional_-_Using_Volatility3)_0" data-path="#Memory_Dump_Analysis_(Optional_-_Using_Volatility3)_0"><div class="tree-item-inner heading-link" heading-name="Memory Dump Analysis (Optional - Using Volatility3)">Memory Dump Analysis (Optional - Using Volatility3)</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Enumeration_0" data-path="#Enumeration_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Enumeration">Enumeration</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Step_1_Search_Memory_Strings_for_Encryption_Clues_0" data-path="#Step_1_Search_Memory_Strings_for_Encryption_Clues_0"><div class="tree-item-inner heading-link" heading-name="Step 1: Search Memory Strings for Encryption Clues">Step 1: Search Memory Strings for Encryption Clues</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Step_2_Extract_ZIP_Archive_from_Memory_0" data-path="#Step_2_Extract_ZIP_Archive_from_Memory_0"><div class="tree-item-inner heading-link" heading-name="Step 2: Extract ZIP Archive from Memory">Step 2: Extract ZIP Archive from Memory</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Step_3_Find_ZIP_Password_0" data-path="#Step_3_Find_ZIP_Password_0"><div class="tree-item-inner heading-link" heading-name="Step 3: Find ZIP Password">Step 3: Find ZIP Password</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Exploitation_0" data-path="#Exploitation_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Exploitation">Exploitation</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Step_1_Decrypt_the_RSA-Encrypted_Key_0" data-path="#Step_1_Decrypt_the_RSA-Encrypted_Key_0"><div class="tree-item-inner heading-link" heading-name="Step 1: Decrypt the RSA-Encrypted Key">Step 1: Decrypt the RSA-Encrypted Key</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Step_2_Decrypt_the_Flag_File_0" data-path="#Step_2_Decrypt_the_Flag_File_0"><div class="tree-item-inner heading-link" heading-name="Step 2: Decrypt the Flag File">Step 2: Decrypt the Flag File</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Post-Exploitation/Flag_0" data-path="#Post-Exploitation/Flag_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Post-Exploitation/Flag">Post-Exploitation/Flag</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Capturing_the_Flag_0" data-path="#Capturing_the_Flag_0"><div class="tree-item-inner heading-link" heading-name="Capturing the Flag">Capturing the Flag</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#Lessons_Learned_0" data-path="#Lessons_Learned_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Lessons Learned">Lessons Learned</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Key_Takeaways_0" data-path="#Key_Takeaways_0"><div class="tree-item-inner heading-link" heading-name="Key Takeaways">Key Takeaways</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Common_Pitfalls_(That_We_Encountered)_0" data-path="#Common_Pitfalls_(That_We_Encountered)_0"><div class="tree-item-inner heading-link" heading-name="Common Pitfalls (That We Encountered)">Common Pitfalls (That We Encountered)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Tools_and_Techniques_for_Future_CTFs_0" data-path="#Tools_and_Techniques_for_Future_CTFs_0"><div class="tree-item-inner heading-link" heading-name="Tools and Techniques for Future CTFs">Tools and Techniques for Future CTFs</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Quick_Reference_Commands_0" data-path="#Quick_Reference_Commands_0"><div class="tree-item-inner heading-link" heading-name="Quick Reference Commands">Quick Reference Commands</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="#References_0" data-path="#References_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="References">References</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Tools_0" data-path="#Tools_0"><div class="tree-item-inner heading-link" heading-name="Tools">Tools</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#Techniques_0" data-path="#Techniques_0"><div class="tree-item-inner heading-link" heading-name="Techniques">Techniques</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="#CTF_Resources_0" data-path="#CTF_Resources_0"><div class="tree-item-inner heading-link" heading-name="CTF Resources">CTF Resources</div></a><div class="tree-item-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></div></body></html>